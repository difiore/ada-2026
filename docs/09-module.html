<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.548">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Applied Data Analysis 2026 - 9&nbsp; Exploratory Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./10-module.html" rel="next">
<link href="./08-module.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


<link rel="stylesheet" href="css/style.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-module.html">Part I - Using <strong><em>R</em></strong> and <strong><em>RStudio</em></strong></a></li><li class="breadcrumb-item"><a href="./09-module.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Applied Data Analysis 2026</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Preliminaries</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-course-logistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Logistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-course-structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Structure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-typography-and-formatting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Typography and Formatting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-programming-style-guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programming Style Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-useful-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Useful Resources</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Part I - Using <strong><em>R</em></strong> and <strong><em>RStudio</em></strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started with <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started with <strong><em>RStudio</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Extending the Functionality of <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fundamentals of the <strong><em>R</em></strong> Language</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Basics of Version Control</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reproducible Research</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Additional Data Structures in <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Getting Data into <strong><em>R</em></strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-module.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Wrangling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Functions and Flow Control</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Part II - Statistics and Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-module.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to Statistics and Sampling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Part III - Miscellany</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Exercises</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Assignments</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">References</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of Packages Used</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#objectives" id="toc-objectives" class="nav-link active" data-scroll-target="#objectives"><span class="header-section-number">9.1</span> Objectives</a></li>
  <li><a href="#preliminaries" id="toc-preliminaries" class="nav-link" data-scroll-target="#preliminaries"><span class="header-section-number">9.2</span> Preliminaries</a></li>
  <li><a href="#backstory" id="toc-backstory" class="nav-link" data-scroll-target="#backstory"><span class="header-section-number">9.3</span> Backstory</a></li>
  <li><a href="#tidy-data" id="toc-tidy-data" class="nav-link" data-scroll-target="#tidy-data"><span class="header-section-number">9.4</span> “Tidy” Data</a></li>
  <li><a href="#exploring-single-variables" id="toc-exploring-single-variables" class="nav-link" data-scroll-target="#exploring-single-variables"><span class="header-section-number">9.5</span> Exploring Single Variables</a>
  <ul class="collapse">
  <li><a href="#variable-summaries" id="toc-variable-summaries" class="nav-link" data-scroll-target="#variable-summaries">Variable Summaries</a></li>
  <li><a href="#challenge" id="toc-challenge" class="nav-link" data-scroll-target="#challenge">CHALLENGE</a></li>
  <li><a href="#boxplots-barplots-and-dotcharts" id="toc-boxplots-barplots-and-dotcharts" class="nav-link" data-scroll-target="#boxplots-barplots-and-dotcharts">Boxplots, Barplots, and Dotcharts</a></li>
  <li><a href="#challenge-1" id="toc-challenge-1" class="nav-link" data-scroll-target="#challenge-1">CHALLENGE</a></li>
  <li><a href="#plotting-with-ggplot2" id="toc-plotting-with-ggplot2" class="nav-link" data-scroll-target="#plotting-with-ggplot2">Plotting with {ggplot2}</a></li>
  <li><a href="#histograms" id="toc-histograms" class="nav-link" data-scroll-target="#histograms">Histograms</a></li>
  <li><a href="#challenge-2" id="toc-challenge-2" class="nav-link" data-scroll-target="#challenge-2">CHALLENGE</a></li>
  <li><a href="#density-plots" id="toc-density-plots" class="nav-link" data-scroll-target="#density-plots">Density Plots</a></li>
  <li><a href="#tables" id="toc-tables" class="nav-link" data-scroll-target="#tables">Tables</a></li>
  <li><a href="#challenge-3" id="toc-challenge-3" class="nav-link" data-scroll-target="#challenge-3">CHALLENGE</a></li>
  </ul></li>
  <li><a href="#exploring-multiple-variables" id="toc-exploring-multiple-variables" class="nav-link" data-scroll-target="#exploring-multiple-variables"><span class="header-section-number">9.6</span> Exploring Multiple Variables</a>
  <ul class="collapse">
  <li><a href="#plotting-several-variables" id="toc-plotting-several-variables" class="nav-link" data-scroll-target="#plotting-several-variables">Plotting Several Variables</a></li>
  <li><a href="#challenge-4" id="toc-challenge-4" class="nav-link" data-scroll-target="#challenge-4">CHALLENGE</a></li>
  <li><a href="#bivariate-scatterplots" id="toc-bivariate-scatterplots" class="nav-link" data-scroll-target="#bivariate-scatterplots">Bivariate Scatterplots</a></li>
  <li><a href="#challenge-5" id="toc-challenge-5" class="nav-link" data-scroll-target="#challenge-5">CHALLENGE</a></li>
  <li><a href="#challenge-6" id="toc-challenge-6" class="nav-link" data-scroll-target="#challenge-6">CHALLENGE</a></li>
  <li><a href="#challenge-7" id="toc-challenge-7" class="nav-link" data-scroll-target="#challenge-7">CHALLENGE</a></li>
  </ul></li>
  <li><a href="#custom-layouts-for-multiple-plots" id="toc-custom-layouts-for-multiple-plots" class="nav-link" data-scroll-target="#custom-layouts-for-multiple-plots"><span class="header-section-number">9.7</span> Custom Layouts for Multiple Plots</a></li>
  <li><a href="#aggregate-statistics" id="toc-aggregate-statistics" class="nav-link" data-scroll-target="#aggregate-statistics"><span class="header-section-number">9.8</span> Aggregate Statistics</a></li>
  <li><a href="#concept-review" id="toc-concept-review" class="nav-link" data-scroll-target="#concept-review">Concept Review</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-module.html">Part I - Using <strong><em>R</em></strong> and <strong><em>RStudio</em></strong></a></li><li class="breadcrumb-item"><a href="./09-module.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="module-09" class="quarto-section-identifier"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="objectives" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="objectives"><span class="header-section-number">9.1</span> Objectives</h2>
<blockquote class="blockquote">
<p>The objective of this module to begin exploring data using the summary functions and graphing abilities of <strong><em>R</em></strong>.</p>
</blockquote>
</section>
<section id="preliminaries" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="preliminaries"><span class="header-section-number">9.2</span> Preliminaries</h2>
<ul>
<li>GO TO: <a href="https://github.com/difiore/ada-datasets" class="uri">https://github.com/difiore/ada-datasets</a>, select the “.csv” version of the “Country-Data-2016” file, then press the “RAW” button, highlight, and copy the text to a text editor and save it locally. Do the same for the “KamilarAndCooperData” file.</li>
<li>Install these packages in <strong><em>R</em></strong>: <a href="https://cran.r-project.org/web/packages/skimr/skimr.pdf">{skimr}</a>, <a href="https://cran.r-project.org/web/packages/summarytools/summarytools.pdf">{summarytools}</a>, <a href="https://cran.r-project.org/web/packages/dataMaid/dataMaid.pdf">{dataMaid}</a>, <a href="https://cran.r-project.org/web/packages/psych/psych.pdf">{psych}</a>, <a href="https://cran.r-project.org/web/packages/pastecs/pastecs.pdf">{pastecs}</a>, <a href="https://cran.r-project.org/web/packages/Hmisc/Hmisc.pdf">{Hmisc}</a>, <a href="https://cran.r-project.org/web/packages/ggExtra/ggExtra.pdf">{ggExtra}</a>, <a href="https://cran.r-project.org/web/packages/car/car.pdf">{car}</a>, <a href="https://cran.r-project.org/web/packages/GGally/GGally.pdf">{GGally}</a>, <a href="https://cran.r-project.org/web/packages/corrplot/corrplot.pdf">{corrplot}</a>, <a href="https://cran.r-project.org/web/packages/patchwork/patchwork.pdf">{patchwork}</a>, <a href="https://cran.r-project.org/web/packages/cowplot/cowplot.pdf">{cowplot}</a>, and <a href="https://cran.r-project.org/web/packages/gridExtra/gridExtra.pdf">{gridExtra}</a></li>
<li>Load {curl} and {tidyverse}</li>
</ul>
</section>
<section id="backstory" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="backstory"><span class="header-section-number">9.3</span> Backstory</h2>
<p>Exploratory data analysis (EDA) is typically the first step in any kind of data analysis in which you examine your dataset, often using visual methods, to summarize the main characteristics of your variables (central tendency, distributions) and check for various issues that may complicate further analysis (e.g., missing data). The influential statistician, John Tukey, wrote a classic book on the subject, <strong><em>Exploratory Data Analysis</em></strong> (Addison-Wesley) in 1977, in which he advocated the use of the <em>five-number summary</em> to quickly understand the distributions of numeric variables. These include:</p>
<ul>
<li>the sample minimum (i.e., the value of the smallest observation)</li>
<li>the lower or first quartile</li>
<li>the median (i.e., the middle value in the distribution of observation)</li>
<li>the upper quartile or third quartile</li>
<li>the sample maximum (i.e., the value of the largest observation)</li>
</ul>
<p><strong><em>R</em></strong> has some very easy to use functions for taking a quick tour of your data. We have seen some of these already (e.g., <code>head()</code>, <code>tail()</code>, and <code>str()</code>), and you should always use these right after loading in a dataset to work with. Also useful are <code>dim()</code> to return the number of rows and columns in a data frame, <code>names()</code>, <code>colnames()</code>, and sometimes <code>rownames()</code>.</p>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> You can use the <code>attach()</code> function to make variables within data frames accessible in <strong><em>R</em></strong> with fewer keystrokes. The <code>attach()</code> function binds the variables from data frame named as an argument to the local namespace so that as long as the data frame is attached, variables can be called by their names without explicitly referring to the data frame. That is, if you <code>attach()</code> a data frame, then you do not need to use the <strong>$</strong> operator or <strong>double bracket notation</strong> to refer to a particular variable or column vector from your data frame.</p>
<p>It is important to remember to <code>detach()</code> data frames when finished. It is also possible to attach multiple data frames (or the same data frame multiple times), and, if these share variable names, then the more recently attached one will mask the other. Thus, it is best to attach only one data frame at a time. You can also <code>attach()</code> and <code>detach()</code> packages from the namespace. In general, I do not recommend using <code>attach()</code> and <code>detach()</code> for dataframes.</p>
</blockquote>
<p><strong>EXAMPLE:</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/Country-Data-2016.csv"</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##  [1] "country"        "population"     "area"           "govt_form"     
##  [5] "birthrate"      "deathrate"      "life_expect"    "mammals"       
##  [9] "birds"          "reptiles"       "amphibians"     "fishes"        
## [13] "mollucs"        "other_inverts"  "plants"         "fungi_protists"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(d)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(life_expect, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 72.19083</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(d)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mean(life_expect, na.rm=TRUE) # this throws an error!</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(d<span class="sc">$</span>life_expect, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 72.19083</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> The <code>with()</code> function accomplishes much the same thing as <code>attach()</code> but is self-contained and cleaner, especially for use in functions. If you use <code>with()</code>, however, all code to be run should be included as an argument of the function.</p>
</blockquote>
<p><strong>EXAMPLE:</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(d, <span class="fu">mean</span>(life_expect, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## [1] 72.19083</code></pre>
</div>
</div>
</section>
<section id="tidy-data" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="tidy-data"><span class="header-section-number">9.4</span> “Tidy” Data</h2>
<p>The tabular data we have worked with thus far has all been presented in a format where each row represents a single case or observation or record, and each column contains a different variable that is scored for each of these observations. Data in this format is referred to as “tidy”, and the {tidyverse} set of <strong><em>R</em></strong> packages (which we have used a bit already) provides many tools for manipulating tabular data in this format.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/tidydata.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>Having data in a “tidy” format is useful for many kinds of analyses (although “tidy” data is not the ONLY useful data format). Often, then, the first manipulations we need to do with data in order to work with it efficiently are to reformat it to make it “tidy”.</p>
<p>There are multiple ways that data can be “non-tidy”, but one common one way is because data is organized in such a way to make data entry in a spreadsheet easier. For example, consider the following table of data representing body weight in grams for three individual titi monkeys, a species of South American primate, collected in each of two years:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Individual</th>
<th style="text-align: center;">Year_1</th>
<th style="text-align: center;">Year_2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Lily</td>
<td style="text-align: center;">580</td>
<td style="text-align: center;">600</td>
</tr>
<tr class="even">
<td style="text-align: left;">Leia</td>
<td style="text-align: center;">550</td>
<td style="text-align: center;">575</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Loki</td>
<td style="text-align: center;">600</td>
<td style="text-align: center;">620</td>
</tr>
</tbody>
</table>
<p>This data is easy to ENTER, but it is non-tidy… Why? Because the latter two columns actually represent a combinations of two variables (“Year” and “Weight”) that pertain to a given individual. Each row thus represents two observations.</p>
<p>Below is the same data in tidy format, where each row represents a single observation:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Individual</th>
<th style="text-align: center;">Year</th>
<th style="text-align: center;">Weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Lily</td>
<td style="text-align: center;">Year_1</td>
<td style="text-align: center;">580</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lily</td>
<td style="text-align: center;">Year_2</td>
<td style="text-align: center;">600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Leia</td>
<td style="text-align: center;">Year_1</td>
<td style="text-align: center;">550</td>
</tr>
<tr class="even">
<td style="text-align: left;">Leia</td>
<td style="text-align: center;">Year_2</td>
<td style="text-align: center;">575</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Loki</td>
<td style="text-align: center;">Year_1</td>
<td style="text-align: center;">600</td>
</tr>
<tr class="even">
<td style="text-align: left;">Loki</td>
<td style="text-align: center;">Year_2</td>
<td style="text-align: center;">620</td>
</tr>
</tbody>
</table>
<p>We can convert data from the former format to the latter using the function <code>pivot_longer()</code>, where the first argument is the tabular data of interest, the next argument is a vector of columns to collect data from, the <code>names_to=</code> argument is the name we will assign to a new variable that indicates from which column values are being collected from in the non-tidy dataset, and the final argument, <code>values_to=</code>, is the name for the new variable into which we are collecting values. This process has the effect, often, of making “wide” tables narrower and longer, thus is sometime referred to as converting data to “long” format, thus the name for the function, <code>pivot_longer()</code>. Note that this function is essentially an update of an older {tidyr} function, <code>gather()</code>, which had a less intuitive name and set of argument names.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Individual =</span> <span class="fu">c</span>(<span class="st">"Lily"</span>, <span class="st">"Leia"</span>, <span class="st">"Loki"</span>), <span class="at">Year_1 =</span> <span class="fu">c</span>(<span class="dv">580</span>, <span class="dv">550</span>, <span class="dv">600</span>),</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">Year_2 =</span> <span class="fu">c</span>(<span class="dv">600</span>, <span class="dv">575</span>, <span class="dv">620</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##   Individual Year_1 Year_2
## 1       Lily    580    600
## 2       Leia    550    575
## 3       Loki    600    620</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(d, <span class="fu">c</span>(<span class="st">"Year_1"</span>, <span class="st">"Year_2"</span>), <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to =</span> <span class="st">"Weight"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 6 × 3
##   Individual Year   Weight
##   &lt;chr&gt;      &lt;chr&gt;   &lt;dbl&gt;
## 1 Lily       Year_1    580
## 2 Lily       Year_2    600
## 3 Leia       Year_1    550
## 4 Leia       Year_2    575
## 5 Loki       Year_1    600
## 6 Loki       Year_2    620</code></pre>
</div>
</div>
<p>Alternatively, sometimes we will have data that is non-tidy because variables for the same observation are presented in different rows. Consider the following example of “non-tidy” data:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Species</th>
<th style="text-align: center;">Variable</th>
<th style="text-align: center;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Orangutans</td>
<td style="text-align: center;">Body Size (kg)</td>
<td style="text-align: center;">37</td>
</tr>
<tr class="even">
<td style="text-align: left;">Orangutans</td>
<td style="text-align: center;">Brain Size (cc)</td>
<td style="text-align: center;">340</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Chimpanzees</td>
<td style="text-align: center;">Body Size (kg)</td>
<td style="text-align: center;">38</td>
</tr>
<tr class="even">
<td style="text-align: left;">Chimpanzees</td>
<td style="text-align: center;">Brain Size (cc)</td>
<td style="text-align: center;">350</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gorillas</td>
<td style="text-align: center;">Body Size (kg)</td>
<td style="text-align: center;">80</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gorillas</td>
<td style="text-align: center;">Brain Size (cc)</td>
<td style="text-align: center;">470</td>
</tr>
</tbody>
</table>
<p>The same data <strong>could</strong> be represented in “tidy” format as:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Species</th>
<th style="text-align: center;">Body Size (kg)</th>
<th style="text-align: center;">Brain Size (cc)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Orangutans</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">340</td>
</tr>
<tr class="even">
<td style="text-align: left;">Chimpanzees</td>
<td style="text-align: center;">38</td>
<td style="text-align: center;">350</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gorillas</td>
<td style="text-align: center;">80</td>
<td style="text-align: center;">470</td>
</tr>
</tbody>
</table>
<p>The <code>pivot_wider()</code> function lets us easily reformat. Here, <code>names_from=</code> is the column containing the different variables, and <code>values_from=</code> is the column containing the measured values of those variables. Note that this function is essentially an update of an older {tidyr} function, <code>spread()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Species =</span> <span class="fu">c</span>(<span class="st">"Orangutans"</span>, <span class="st">"Orangutans"</span>, <span class="st">"Chimpanzees"</span>, <span class="st">"Chimpanzees"</span>,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gorillas"</span>, <span class="st">"Gorillas"</span>), <span class="at">Variable =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Body Size (kg)"</span>, <span class="st">"Brain Size (cc)"</span>),</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>), <span class="at">Value =</span> <span class="fu">c</span>(<span class="dv">37</span>, <span class="dv">340</span>, <span class="dv">38</span>, <span class="dv">350</span>, <span class="dv">80</span>, <span class="dv">470</span>))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##       Species        Variable Value
## 1  Orangutans  Body Size (kg)    37
## 2  Orangutans Brain Size (cc)   340
## 3 Chimpanzees  Body Size (kg)    38
## 4 Chimpanzees Brain Size (cc)   350
## 5    Gorillas  Body Size (kg)    80
## 6    Gorillas Brain Size (cc)   470</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(d, <span class="at">names_from =</span> <span class="st">"Variable"</span>, <span class="at">values_from =</span> <span class="st">"Value"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 3 × 3
##   Species     `Body Size (kg)` `Brain Size (cc)`
##   &lt;chr&gt;                  &lt;dbl&gt;             &lt;dbl&gt;
## 1 Orangutans                37               340
## 2 Chimpanzees               38               350
## 3 Gorillas                  80               470</code></pre>
</div>
</div>
<p>This process has the effect, often, of making long and narrow tables wider, thus is sometime referred to as converting data to “wide” format.</p>
<p>The image below, pulled from a cheatsheet on <a href="cheatsheets/data-wrangling.pdf">Data Wrangling with {dplyr} and {tidyr}</a>, summarizes the basics of these processes for “reshaping” data.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/reshaping.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>For the remainder of this module, all of the example datasets will comprise data already in the “tidy” format.</p>
</section>
<section id="exploring-single-variables" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="exploring-single-variables"><span class="header-section-number">9.5</span> Exploring Single Variables</h2>
<section id="variable-summaries" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="variable-summaries">Variable Summaries</h3>
<p>The <code>summary()</code> function from {base} <strong><em>R</em></strong> provides a quick overview of each variable in a data frame. For <strong>numeric</strong> variables, this includes the five-number summary and the mean, as well as a count of <code>NA</code> (missing values). For <strong>factors</strong>, it includes a count of each factor.</p>
</section>
<section id="challenge" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge">CHALLENGE</h3>
<ul>
<li>Load the “Country-Data-2016” dataset into a data frame variable, <strong>d</strong>, and summarize the variables in that data frame. You can load the file any way you want, e.g., load from a local file or access the data straight from <strong><em>GitHub</em></strong>, as in the code below.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using {base} R</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">curl</span>(<span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/Country-Data-2016.csv"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(f, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(d)  <span class="co"># I like tibbles!</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 6 × 16
##   country    population   area govt_form birthrate deathrate life_expect mammals
##   &lt;chr&gt;           &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;   &lt;int&gt;
## 1 Afghanist…   32564342 6.52e5 islamic …      38.6      13.9        50.9      11
## 2 Albania       3029278 2.87e4 republic       12.9       6.6        78.1       3
## 3 Algeria      39542166 2.38e6 republic       23.7       4.3        76.6      14
## 4 American …      54343 1.99e2 territor…      22.9       4.8        75.1       1
## 5 Andorra         85580 4.68e2 constitu…       8.1       7          82.7       2
## 6 Angola       19625353 1.25e6 republic       38.8      11.5        55.6      17
## # ℹ 8 more variables: birds &lt;int&gt;, reptiles &lt;int&gt;, amphibians &lt;int&gt;,
## #   fishes &lt;int&gt;, mollucs &lt;int&gt;, other_inverts &lt;int&gt;, plants &lt;int&gt;,
## #   fungi_protists &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##  [1] "country"        "population"     "area"           "govt_form"     
##  [5] "birthrate"      "deathrate"      "life_expect"    "mammals"       
##  [9] "birds"          "reptiles"       "amphibians"     "fishes"        
## [13] "mollucs"        "other_inverts"  "plants"         "fungi_protists"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or, using {readr}</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/Country-Data-2016.csv"</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>## Rows: 248 Columns: 16
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## chr  (2): country, govt_form
## dbl (14): population, area, birthrate, deathrate, life_expect, mammals, bird...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 6 × 16
##   country    population   area govt_form birthrate deathrate life_expect mammals
##   &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;
## 1 Afghanist…   32564342 6.52e5 islamic …      38.6      13.9        50.9      11
## 2 Albania       3029278 2.87e4 republic       12.9       6.6        78.1       3
## 3 Algeria      39542166 2.38e6 republic       23.7       4.3        76.6      14
## 4 American …      54343 1.99e2 territor…      22.9       4.8        75.1       1
## 5 Andorra         85580 4.68e2 constitu…       8.1       7          82.7       2
## 6 Angola       19625353 1.25e6 republic       38.8      11.5        55.6      17
## # ℹ 8 more variables: birds &lt;dbl&gt;, reptiles &lt;dbl&gt;, amphibians &lt;dbl&gt;,
## #   fishes &lt;dbl&gt;, mollucs &lt;dbl&gt;, other_inverts &lt;dbl&gt;, plants &lt;dbl&gt;,
## #   fungi_protists &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##  [1] "country"        "population"     "area"           "govt_form"     
##  [5] "birthrate"      "deathrate"      "life_expect"    "mammals"       
##  [9] "birds"          "reptiles"       "amphibians"     "fishes"        
## [13] "mollucs"        "other_inverts"  "plants"         "fungi_protists"</code></pre>
</div>
</div>
<ul>
<li>What are the median area and population size of all countries in the dataset?</li>
</ul>
<blockquote class="blockquote">
<p><strong>HINT:</strong> There are a couple of ways to do this… try <code>summary()</code> and <code>median()</code> (for the latter, you’ll need to use the <code>na.rm=TRUE</code> argument).</p>
</blockquote>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>##    country            population             area            govt_form        
##  Length:248         Min.   :3.000e+01   Min.   :1.000e-01   Length:248        
##  Class :character   1st Qu.:2.991e+05   1st Qu.:1.769e+03   Class :character  
##  Mode  :character   Median :4.912e+06   Median :6.970e+04   Mode  :character  
##                     Mean   :2.999e+07   Mean   :6.110e+05                     
##                     3rd Qu.:1.803e+07   3rd Qu.:3.988e+05                     
##                     Max.   :1.367e+09   Max.   :1.710e+07                     
##                     NA's   :6           NA's   :1                             
##    birthrate       deathrate      life_expect       mammals      
##  Min.   : 0.00   Min.   : 0.00   Min.   :49.80   Min.   :  0.00  
##  1st Qu.:11.40   1st Qu.: 5.65   1st Qu.:67.40   1st Qu.:  3.00  
##  Median :16.40   Median : 7.40   Median :74.70   Median :  8.00  
##  Mean   :18.95   Mean   : 7.61   Mean   :72.19   Mean   : 13.85  
##  3rd Qu.:24.35   3rd Qu.: 9.40   3rd Qu.:78.40   3rd Qu.: 15.00  
##  Max.   :45.50   Max.   :14.90   Max.   :89.50   Max.   :188.00  
##  NA's   :17      NA's   :17      NA's   :19      NA's   :3       
##      birds           reptiles         amphibians          fishes      
##  Min.   :  0.00   Min.   :  0.000   Min.   :  0.000   Min.   :  0.00  
##  1st Qu.:  6.00   1st Qu.:  2.000   1st Qu.:  0.000   1st Qu.: 11.00  
##  Median : 12.00   Median :  5.000   Median :  0.000   Median : 25.00  
##  Mean   : 17.82   Mean   :  8.331   Mean   :  9.849   Mean   : 32.84  
##  3rd Qu.: 19.00   3rd Qu.:  8.000   3rd Qu.:  4.000   3rd Qu.: 43.00  
##  Max.   :165.00   Max.   :139.000   Max.   :215.000   Max.   :249.00  
##  NA's   :3        NA's   :3         NA's   :3         NA's   :3       
##     mollucs       other_inverts        plants        fungi_protists   
##  Min.   :  0.00   Min.   :  0.00   Min.   :   0.00   Min.   : 0.0000  
##  1st Qu.:  0.00   1st Qu.:  3.00   1st Qu.:   2.00   1st Qu.: 0.0000  
##  Median :  1.00   Median : 11.00   Median :  10.00   Median : 0.0000  
##  Mean   :  9.62   Mean   : 32.57   Mean   :  60.78   Mean   : 0.6082  
##  3rd Qu.:  6.00   3rd Qu.: 33.00   3rd Qu.:  44.00   3rd Qu.: 0.0000  
##  Max.   :301.00   Max.   :340.00   Max.   :1856.00   Max.   :12.0000  
##  NA's   :3        NA's   :3        NA's   :3         NA's   :3</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(d<span class="sc">$</span>area, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 69700</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(d<span class="sc">$</span>population, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 4911766</code></pre>
</details>
</div>
</div>
<ul>
<li>Create a new <strong>density</strong> variable in your data frame which is population / area. What are the 10 most dense countries? The 10 least dense?</li>
</ul>
<blockquote class="blockquote">
<p><strong>HINT:</strong> Check out the <code>order()</code> function.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>density <span class="ot">&lt;-</span> d<span class="sc">$</span>population<span class="sc">/</span>d<span class="sc">$</span>area</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d[<span class="fu">order</span>(d<span class="sc">$</span>density, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]  <span class="co"># or</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d[<span class="fu">order</span>(<span class="sc">-</span>d<span class="sc">$</span>density), ]</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>d[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## # A tibble: 10 × 17
##    country   population   area govt_form birthrate deathrate life_expect mammals
##    &lt;chr&gt;          &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;
##  1 Macau         592731   28   special …       8.9       4.2        84.5       0
##  2 Monaco         30535    2   constitu…       6.7       9.2        89.5       3
##  3 Holy See…        842    0.1 monarchy       NA        NA          NA         1
##  4 Singapore    5674472  697   republic        8.3       3.4        84.7      13
##  5 Hong Kong    7141106 1108   special …       9.2       7.1        82.9       3
##  6 Gibraltar      29258    7   British …      14.1       8.4        79.3       4
##  7 Bahrain      1346613  760   constitu…      13.7       2.7        78.7       3
##  8 Maldives      393253  298   republic       15.8       3.9        75.4       2
##  9 Malta         413965  316   republic       10.2       9.1        80.2       2
## 10 Bermuda        70196   54   British …      11.3       8.2        81.2       4
## # ℹ 9 more variables: birds &lt;dbl&gt;, reptiles &lt;dbl&gt;, amphibians &lt;dbl&gt;,
## #   fishes &lt;dbl&gt;, mollucs &lt;dbl&gt;, other_inverts &lt;dbl&gt;, plants &lt;dbl&gt;,
## #   fungi_protists &lt;dbl&gt;, density &lt;dbl&gt;</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d[<span class="fu">order</span>(d<span class="sc">$</span>density), ]</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>d[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## # A tibble: 10 × 17
##    country   population   area govt_form birthrate deathrate life_expect mammals
##    &lt;chr&gt;          &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;
##  1 South Ge…         30 3.90e3 British …      NA        NA          NA         3
##  2 Greenland      57733 2.17e6 autonomo…      14.5       8.5        72.1       9
##  3 Falkland…       3361 1.22e4 British …      NA        NA          NA         4
##  4 Pitcairn…         48 4.7 e1 British …      NA        NA          NA         1
##  5 Mongolia     2992908 1.56e6 republic       20.3       6.4        69.3      11
##  6 Western …     570866 2.66e5 autonomo…      30.2       8.3        62.6      10
##  7 French G…     181000 8.35e4 overseas…       0         0          76.1       8
##  8 Namibia      2212307 8.24e5 republic       19.8      13.9        51.6      14
##  9 Australia   22751014 7.74e6 parliame…      12.2       7.1        82.2      63
## 10 Iceland       331918 1.03e5 republic       13.9       6.3        83         6
## # ℹ 9 more variables: birds &lt;dbl&gt;, reptiles &lt;dbl&gt;, amphibians &lt;dbl&gt;,
## #   fishes &lt;dbl&gt;, mollucs &lt;dbl&gt;, other_inverts &lt;dbl&gt;, plants &lt;dbl&gt;,
## #   fungi_protists &lt;dbl&gt;, density &lt;dbl&gt;</code></pre>
</details>
</div>
</div>
<ul>
<li>Use subsetting or filtering to extract data from the 20 largest countries into a new variable, <strong>s</strong>. What are the median area and population size of these countries?</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> d[<span class="fu">order</span>(<span class="sc">-</span>d<span class="sc">$</span>population), ]</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> s[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, ]</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>med_area <span class="ot">&lt;-</span> <span class="fu">median</span>(s<span class="sc">$</span>area, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>med_area</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 1052875</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>med_pop <span class="ot">&lt;-</span> <span class="fu">median</span>(s<span class="sc">$</span>population, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>med_pop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 124328234</code></pre>
</details>
</div>
</div>
<ul>
<li>Extract data from all countries beginning with the letters “A” through “F”. What are the mean area and population size of these countries?</li>
</ul>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> Single bracket notation subsetting is used here to return the rows of the <strong>d</strong> data frame where the country name (<code>d$country</code>) begins with the capital letters “A” through “F”. The <code>grep()</code> function is a pattern recognition function that uses a <strong>regular expression</strong> to pull out the country names of interest.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> d[<span class="fu">grep</span>(<span class="at">pattern =</span> <span class="st">"^[A-F]"</span>, d<span class="sc">$</span>country), ]</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>##    country            population             area           govt_form        
##  Length:78          Min.   :5.960e+02   Min.   :      14   Length:78         
##  Class :character   1st Qu.:2.991e+05   1st Qu.:    4066   Class :character  
##  Mode  :character   Median :4.785e+06   Median :   51148   Mode  :character  
##                     Mean   :3.507e+07   Mean   :  918248                     
##                     3rd Qu.:1.469e+07   3rd Qu.:  466498                     
##                     Max.   :1.367e+09   Max.   :14000000                     
##                     NA's   :4                                                
##    birthrate       deathrate       life_expect       mammals    
##  Min.   : 0.00   Min.   : 0.000   Min.   :49.80   Min.   : 0.0  
##  1st Qu.:11.65   1st Qu.: 5.850   1st Qu.:68.75   1st Qu.: 3.0  
##  Median :15.90   Median : 7.700   Median :75.50   Median : 7.0  
##  Mean   :18.77   Mean   : 7.861   Mean   :72.25   Mean   :13.4  
##  3rd Qu.:23.30   3rd Qu.: 9.500   3rd Qu.:78.40   3rd Qu.:14.0  
##  Max.   :42.00   Max.   :14.400   Max.   :82.70   Max.   :81.0  
##  NA's   :7       NA's   :7        NA's   :7                     
##      birds           reptiles        amphibians         fishes      
##  Min.   :  0.00   Min.   : 0.000   Min.   :  0.00   Min.   :  0.00  
##  1st Qu.:  6.00   1st Qu.: 2.000   1st Qu.:  0.00   1st Qu.: 10.00  
##  Median : 11.00   Median : 5.000   Median :  0.00   Median : 24.50  
##  Mean   : 18.62   Mean   : 7.397   Mean   : 11.86   Mean   : 29.54  
##  3rd Qu.: 18.00   3rd Qu.: 8.000   3rd Qu.:  3.00   3rd Qu.: 41.50  
##  Max.   :165.00   Max.   :43.000   Max.   :215.00   Max.   :133.00  
##                                                                     
##     mollucs       other_inverts        plants        fungi_protists  
##  Min.   :  0.00   Min.   :  0.00   Min.   :   0.00   Min.   :0.0000  
##  1st Qu.:  0.00   1st Qu.:  4.00   1st Qu.:   2.25   1st Qu.:0.0000  
##  Median :  1.00   Median : 11.00   Median :  10.00   Median :0.0000  
##  Mean   : 10.17   Mean   : 23.63   Mean   :  70.64   Mean   :0.6026  
##  3rd Qu.:  5.00   3rd Qu.: 25.25   3rd Qu.:  41.75   3rd Qu.:0.0000  
##  Max.   :174.00   Max.   :340.00   Max.   :1856.00   Max.   :8.0000  
##                                                                      
##     density         
##  Min.   :   0.2761  
##  1st Qu.:  24.5932  
##  Median :  75.0297  
##  Mean   : 162.4785  
##  3rd Qu.: 140.7140  
##  Max.   :1771.8592  
##  NA's   :4</code></pre>
</details>
</div>
</div>
<p>Doing the same thing with {dplyr} verbs (see <a href="10-module.html"><strong>Module 10</strong></a>) is easier…</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">filter</span>(d, <span class="fu">grepl</span>(<span class="at">pattern =</span> <span class="st">"^[A-F]"</span>, country))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>##    country            population             area           govt_form        
##  Length:78          Min.   :5.960e+02   Min.   :      14   Length:78         
##  Class :character   1st Qu.:2.991e+05   1st Qu.:    4066   Class :character  
##  Mode  :character   Median :4.785e+06   Median :   51148   Mode  :character  
##                     Mean   :3.507e+07   Mean   :  918248                     
##                     3rd Qu.:1.469e+07   3rd Qu.:  466498                     
##                     Max.   :1.367e+09   Max.   :14000000                     
##                     NA's   :4                                                
##    birthrate       deathrate       life_expect       mammals    
##  Min.   : 0.00   Min.   : 0.000   Min.   :49.80   Min.   : 0.0  
##  1st Qu.:11.65   1st Qu.: 5.850   1st Qu.:68.75   1st Qu.: 3.0  
##  Median :15.90   Median : 7.700   Median :75.50   Median : 7.0  
##  Mean   :18.77   Mean   : 7.861   Mean   :72.25   Mean   :13.4  
##  3rd Qu.:23.30   3rd Qu.: 9.500   3rd Qu.:78.40   3rd Qu.:14.0  
##  Max.   :42.00   Max.   :14.400   Max.   :82.70   Max.   :81.0  
##  NA's   :7       NA's   :7        NA's   :7                     
##      birds           reptiles        amphibians         fishes      
##  Min.   :  0.00   Min.   : 0.000   Min.   :  0.00   Min.   :  0.00  
##  1st Qu.:  6.00   1st Qu.: 2.000   1st Qu.:  0.00   1st Qu.: 10.00  
##  Median : 11.00   Median : 5.000   Median :  0.00   Median : 24.50  
##  Mean   : 18.62   Mean   : 7.397   Mean   : 11.86   Mean   : 29.54  
##  3rd Qu.: 18.00   3rd Qu.: 8.000   3rd Qu.:  3.00   3rd Qu.: 41.50  
##  Max.   :165.00   Max.   :43.000   Max.   :215.00   Max.   :133.00  
##                                                                     
##     mollucs       other_inverts        plants        fungi_protists  
##  Min.   :  0.00   Min.   :  0.00   Min.   :   0.00   Min.   :0.0000  
##  1st Qu.:  0.00   1st Qu.:  4.00   1st Qu.:   2.25   1st Qu.:0.0000  
##  Median :  1.00   Median : 11.00   Median :  10.00   Median :0.0000  
##  Mean   : 10.17   Mean   : 23.63   Mean   :  70.64   Mean   :0.6026  
##  3rd Qu.:  5.00   3rd Qu.: 25.25   3rd Qu.:  41.75   3rd Qu.:0.0000  
##  Max.   :174.00   Max.   :340.00   Max.   :1856.00   Max.   :8.0000  
##                                                                      
##     density         
##  Min.   :   0.2761  
##  1st Qu.:  24.5932  
##  Median :  75.0297  
##  Mean   : 162.4785  
##  3rd Qu.: 140.7140  
##  Max.   :1771.8592  
##  NA's   :4</code></pre>
</details>
</div>
</div>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> Here, we use <code>grepl()</code> instead of <code>grep()</code> because we want to return a logical vector for all of the elements of “country” to <code>filter()</code> on the basis of. <code>grep()</code> returns a vector of index positions.</p>
</blockquote>
<p>Or, instead of <code>summary()</code>, we can use <code>mean()</code> with the <code>na.rm=TRUE</code> argument…</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(s<span class="sc">$</span>population, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 35065172</code></pre>
</details>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(s<span class="sc">$</span>area, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## [1] 918247.7</code></pre>
</details>
</div>
</div>
<p>There are a number of other packages and associated functions we might also use to generate nice summaries of our data.</p>
<p>For example, with the <code>skim()</code> function from {skimr}, you can get for numeric variables a count of observations, the number of missing observations, the mean and standard deviation, and the five-number summary. The <code>select()</code>, <code>kable()</code> and <code>kable_styling()</code> functions will format the output nicely!</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">skim</span>(d)  <span class="co"># the main `skimr()` function</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>s <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(skim_type <span class="sc">==</span> <span class="st">"numeric"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">variable =</span> skim_variable, <span class="at">missing =</span> n_missing, <span class="at">mean =</span> numeric.mean, <span class="at">sd =</span> numeric.sd,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">min =</span> numeric.p0, <span class="at">p25 =</span> numeric.p25, <span class="at">median =</span> numeric.p50, <span class="at">p75 =</span> numeric.p75,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">max =</span> numeric.p100, <span class="at">hist =</span> numeric.hist) <span class="sc">%&gt;%</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(variable, missing, mean, sd, min, median, max, hist) <span class="sc">%&gt;%</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># drop p25 and p75 for purposes of display</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">10</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">missing</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">min</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">median</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">max</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">population</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2.998647e+07</td>
<td style="text-align: right;">1.241345e+08</td>
<td style="text-align: right;">30.0000000</td>
<td style="text-align: right;">4.911766e+06</td>
<td style="text-align: right;">1.367485e+09</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">area</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6.109518e+05</td>
<td style="text-align: right;">1.927077e+06</td>
<td style="text-align: right;">0.1000000</td>
<td style="text-align: right;">6.970000e+04</td>
<td style="text-align: right;">1.709824e+07</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">birthrate</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">1.894892e+01</td>
<td style="text-align: right;">9.925912e+00</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.640000e+01</td>
<td style="text-align: right;">4.550000e+01</td>
<td style="text-align: left;">▂▇▅▂▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">deathrate</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">7.610390e+00</td>
<td style="text-align: right;">3.135197e+00</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">7.400000e+00</td>
<td style="text-align: right;">1.490000e+01</td>
<td style="text-align: left;">▁▅▇▃▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">life_expect</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">7.219083e+01</td>
<td style="text-align: right;">8.587024e+00</td>
<td style="text-align: right;">49.8000000</td>
<td style="text-align: right;">7.470000e+01</td>
<td style="text-align: right;">8.950000e+01</td>
<td style="text-align: left;">▂▂▃▇▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">mammals</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.385306e+01</td>
<td style="text-align: right;">2.058178e+01</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">8.000000e+00</td>
<td style="text-align: right;">1.880000e+02</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">birds</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.781633e+01</td>
<td style="text-align: right;">2.213342e+01</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.200000e+01</td>
<td style="text-align: right;">1.650000e+02</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">reptiles</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8.330612e+00</td>
<td style="text-align: right;">1.408903e+01</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">5.000000e+00</td>
<td style="text-align: right;">1.390000e+02</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">amphibians</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">9.848980e+00</td>
<td style="text-align: right;">2.869408e+01</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.000000e+00</td>
<td style="text-align: right;">2.150000e+02</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">fishes</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3.283673e+01</td>
<td style="text-align: right;">3.552576e+01</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">2.500000e+01</td>
<td style="text-align: right;">2.490000e+02</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mollucs</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">9.620408e+00</td>
<td style="text-align: right;">2.734627e+01</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.000000e+00</td>
<td style="text-align: right;">3.010000e+02</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">other_inverts</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3.256735e+01</td>
<td style="text-align: right;">5.362966e+01</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.100000e+01</td>
<td style="text-align: right;">3.400000e+02</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">plants</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">6.077551e+01</td>
<td style="text-align: right;">1.618624e+02</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.000000e+01</td>
<td style="text-align: right;">1.856000e+03</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">fungi_protists</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">6.081633e-01</td>
<td style="text-align: right;">1.847000e+00</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.000000e+00</td>
<td style="text-align: right;">1.200000e+01</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">density</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">4.230267e+02</td>
<td style="text-align: right;">1.882632e+03</td>
<td style="text-align: right;">0.0076864</td>
<td style="text-align: right;">8.389234e+01</td>
<td style="text-align: right;">2.116896e+04</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>kableExtra)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>skimr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With <code>descr()</code>, <code>dfSummary()</code>, and <code>view()</code> from the {summarytools} package, you can also return nicely formatted tables of summary statistics. Note that the output of the code below is not shown.</p>
<blockquote class="blockquote">
<p><strong>CAUTION:</strong> Q1 and Q3 (the equivalent of “numeric.p25” and “numeric.p75”) are calculated slightly differently for <code>descr()</code> and <code>dfSummary()</code> than for <code>summary()</code> and <code>skim()</code>!</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">descr</span>(d, <span class="at">style =</span> <span class="st">"rmarkdown"</span>, <span class="at">transpose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;% to view() print nicely formatted table to viewer</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>s <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    summarytools<span class="sc">::</span><span class="fu">view</span>()</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">dfSummary</span>(d, <span class="at">style =</span> <span class="st">"grid"</span>, <span class="at">plain.ascii =</span> <span class="cn">FALSE</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>s <span class="sc">%&gt;%</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    summarytools<span class="sc">::</span><span class="fu">view</span>()</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>summarytools)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With <code>makeDataReport()</code> from the {dataMaid} package, you can generate a nicely formated report that gets written out to a location of your choice. Again, the output of this code is not shown as it generates a report in an external file.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dataMaid)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this code below produces a formated report, with the type of report specified</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># by `output=`</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">makeDataReport</span>(d, <span class="at">output =</span> <span class="st">"html"</span>, <span class="at">file =</span> <span class="st">"~/Desktop/dataMaid-output.Rmd"</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>dataMaid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Additionally, the packages {psych}, {pastecs}, and {Hmisc} also all contain functions for producing variable summaries:</p>
<p><code>psych::describe(d)</code></p>
<p><code>pastecs::stat.desc(d)</code></p>
<p><code>Hmisc::describe(d)</code></p>
</section>
<section id="boxplots-barplots-and-dotcharts" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="boxplots-barplots-and-dotcharts">Boxplots, Barplots, and Dotcharts</h3>
<p>The <code>boxplot()</code> function from {base} <strong><em>R</em></strong> provides a box-and-whiskers visual representation of the five-number summary, sometimes noting outliers that go beyond the bulk of the data. The function balks if you pass it nonnumeric data, so you will want to reference columns of interest specifically using either <strong>double bracket notation</strong> or the <strong>$</strong> operator.</p>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> Actually, it is technically not true that <code>boxplot()</code> always shows you the five-number summary. One of the default arguments for <code>boxplot()</code> includes <code>range=1.5</code>, which means that the “whiskers” of the boxplot extend to 1.5 times the interquartile range, and then values more extreme than that are indicated as single points. If <code>range=0</code>, then, the “whiskers” extend to the minimum and maximum values of the data.</p>
</blockquote>
<p>The <code>barplot()</code> function is also useful taking a quick look at crude data, with bar height proportional to the value of the variable. The function <code>dotchart()</code> provides a similar graphical summary.</p>
</section>
<section id="challenge-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-1">CHALLENGE</h3>
<ul>
<li>Make boxplots, barplots, and dotcharts of the raw population and area data, then <code>log()</code> transform the variables and repeat the boxplots.</li>
</ul>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> The <code>par()</code> command in the code below lets you set up a grid of panels in which to plot. Here, we set up a 1 row x 2 column grid.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>log_population <span class="ot">&lt;-</span> <span class="fu">log</span>(d<span class="sc">$</span>population)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>log_area <span class="ot">&lt;-</span> <span class="fu">log</span>(d<span class="sc">$</span>area)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(d<span class="sc">$</span>population, <span class="at">ylab =</span> <span class="st">"Population"</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(d<span class="sc">$</span>area, <span class="at">ylab =</span> <span class="st">"Area"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(d<span class="sc">$</span>population, <span class="at">xlab =</span> <span class="st">"Case"</span>, <span class="at">ylab =</span> <span class="st">"Population"</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dotchart</span>(d<span class="sc">$</span>population, <span class="at">xlab =</span> <span class="st">"Population"</span>, <span class="at">ylab =</span> <span class="st">"Case"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(d<span class="sc">$</span>area, <span class="at">xlab =</span> <span class="st">"Case"</span>, <span class="at">ylab =</span> <span class="st">"Area"</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dotchart</span>(d<span class="sc">$</span>area, <span class="at">xlab =</span> <span class="st">"Area"</span>, <span class="at">ylab =</span> <span class="st">"Case"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-20-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(d<span class="sc">$</span>log_population, <span class="at">ylab =</span> <span class="st">"log(Population)"</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(d<span class="sc">$</span>log_area, <span class="at">ylab =</span> <span class="st">"log(Area)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-20-4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plotting-with-ggplot2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="plotting-with-ggplot2">Plotting with {ggplot2}</h3>
<p>As an alternative for plotting, we can use the “grammar of graphics” {ggplot2} package:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first, we use `tidyr::pivot_longer()` to convert our data from wide to long</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># format this is so we can use `facet.grid()`</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># uncomment this to look at a different set of variables d_long &lt;-</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># pivot_longer(d, c('log_population','log_area'), names_to='Variable',</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co"># values_to='Value')</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="co"># uncomment this to look at a different set of variables d_long &lt;-</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="co"># pivot_longer(d, c('mammals','birds','reptiles','fishes'),</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="co"># names_to='Variable', values_to='Value')</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>d_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(d, <span class="fu">c</span>(<span class="st">"birthrate"</span>, <span class="st">"deathrate"</span>, <span class="st">"life_expect"</span>), <span class="at">names_to =</span> <span class="st">"Variable"</span>,</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(<span class="dv">0</span>), <span class="at">y =</span> Value)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">"y"</span>, <span class="at">stackdir =</span> <span class="st">"center"</span>,</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">stackratio =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">dotsize =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> Variable) <span class="sc">+</span> <span class="fu">geom_rug</span>(<span class="at">sides =</span> <span class="st">"l"</span>)</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>## Warning: Removed 53 rows containing missing values or values outside the scale range
## (`geom_rug()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(<span class="dv">0</span>), <span class="at">y =</span> Value)) <span class="sc">+</span> <span class="fu">geom_violin</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">"y"</span>,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">stackdir =</span> <span class="st">"center"</span>, <span class="at">stackratio =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">dotsize =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="cn">NA</span>,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">facet_grid</span>(. <span class="sc">~</span> Variable) <span class="sc">+</span> <span class="fu">geom_rug</span>(<span class="at">sides =</span> <span class="st">"l"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>## Warning: The `draw_quantiles` argument of `geom_violin()` is deprecated as of ggplot2
## 4.0.0.
## ℹ Please use the `quantiles.linetype` argument instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>## Warning: Removed 53 rows containing missing values or values outside the scale range
## (`geom_rug()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="histograms" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="histograms">Histograms</h3>
<p>The <code>hist()</code> function returns a histogram showing the complete empirical distribution of the data in binned categories, which is useful for checking skewwness of the data, symmetry, multi-modality, etc. Setting the argument <code>freq=FALSE</code> will scale the Y axis to represent the <em>proportion</em> of observations falling into each bin rather than the <em>count</em>.</p>
</section>
<section id="challenge-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-2">CHALLENGE</h3>
<ul>
<li>Make histograms of the <code>log()</code> transformed population and area data from the “Country-Data-2016” file. Explore what happens if you set <code>freq=FALSE</code> versus the default of <code>freq=TRUE</code>. Try looking at other variables as well.</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))  <span class="co"># sets up two panels side by side</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(d)  <span class="co"># lets us use variable names without specifying the data frame!</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(population), <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">main =</span> <span class="st">"Plot 1"</span>, <span class="at">xlab =</span> <span class="st">"log(population size)"</span>,</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"density"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>))</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(area), <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">main =</span> <span class="st">"Plot 2"</span>, <span class="at">xlab =</span> <span class="st">"log(area)"</span>, <span class="at">ylab =</span> <span class="st">"density"</span>,</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> You can add lines to your histograms (e.g., to show the mean value for a variable) using the <code>abline()</code> command, with arguments. For example, to show a single <em>vertical</em> line representing the mean log(population size), you would add the argument <code>v=mean(log(area), na.rm=TRUE)</code>. We need to set <code>na.rm</code> to be TRUE otherwise the <code>mean()</code> function will not run the way we expect.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(area), <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">main =</span> <span class="st">"Plot 2"</span>, <span class="at">xlab =</span> <span class="st">"log(area)"</span>, <span class="at">ylab =</span> <span class="st">"density"</span>,</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>))</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(<span class="fu">log</span>(area), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="density-plots" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="density-plots">Density Plots</h3>
<p>The <code>density()</code> function computes a non-parametric estimate of the distribution of a variable, which can be combined with other plots to also yield a graphical view of the distribution of the data. If your data have missing values, then you need to add the argument <code>na.rm=TRUE</code> to the <code>density()</code> function. To superimpose a <code>density()</code> curve on a histogram, you can use the <code>lines(density())</code> function.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))  <span class="co"># set up one panel and redraw the log(population) histogram</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(population), <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="st">"white"</span>, <span class="at">main =</span> <span class="st">"Density Plot with Mean"</span>,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"log(population size)"</span>, <span class="at">ylab =</span> <span class="st">"density"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>))</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(<span class="fu">log</span>(population), <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(<span class="fu">log</span>(population), <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">col =</span> <span class="st">"green"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tables" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="tables">Tables</h3>
<p>The <code>table()</code> function can be used to summarize counts and proportions for categorical variables in your dataset.</p>
</section>
<section id="challenge-3" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-3">CHALLENGE</h3>
<ul>
<li>Using the <code>table()</code> function, find what is the most common form of government in the “Country-Data-2016” dataset. How many countries have that form?</li>
</ul>
<blockquote class="blockquote">
<p><strong>HINT:</strong> We can combine <code>table()</code> with <code>sort()</code> and the argument <code>decreasing=TRUE</code> to get the desired answered straight away.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">table</span>(d<span class="sc">$</span>govt_form), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## 
##                                republic                 constitutional monarchy 
##                                     127                                      33 
##              British overseas territory            overseas territory of France 
##                                      12                                       7 
##           presidential federal republic                                monarchy 
##                                       7                                       6 
##                  parliamentary monarchy          territory of the United States 
##                                       5                                       5 
##                 parliamentary democracy                  territory of Australia 
##                                       4                                       4 
## autonomous territory of the Netherlands                        federal republic 
##                                       3                                       3 
##                        islamic republic                      socialist republic 
##                                       3                                       3 
##                       absolute monarchy            autonomous region of Denmark 
##                                       2                                       2 
##     autonomous territory of New Zealand            overseas community of France 
##                                       2                                       2 
##          parliamentary federal republic  special administrative region of China 
##                                       2                                       2 
##                     territory of Norway                       autonomous region 
##                                       2                                       1 
##             autonomous region of France            autonomous region of Morocco 
##                                       1                                       1 
##                              federation         foreign-administrated territory 
##                                       1                                       1 
##      islamic-socialist peoples republic                  parliamentary republic 
##                                       1                                       1 
##                        peoples republic                     territory of France 
##                                       1                                       1 
##                territory of New Zealand            territory of the Netherlands 
##                                       1                                       1</code></pre>
</details>
</div>
</div>
<p>Doing the same thing with {dplyr} verbs (see <a href="10-module.html"><strong>Module 10</strong></a>) provides nicer output…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">group_by</span>(d, govt_form) <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## # A tibble: 33 × 2
##    govt_form                      count
##    &lt;chr&gt;                          &lt;int&gt;
##  1 republic                         127
##  2 constitutional monarchy           33
##  3 British overseas territory        12
##  4 overseas territory of France       7
##  5 presidential federal republic      7
##  6 monarchy                           6
##  7 parliamentary monarchy             5
##  8 territory of the United States     5
##  9 parliamentary democracy            4
## 10 territory of Australia             4
## # ℹ 23 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="exploring-multiple-variables" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="exploring-multiple-variables"><span class="header-section-number">9.6</span> Exploring Multiple Variables</h2>
<section id="plotting-several-variables" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="plotting-several-variables">Plotting Several Variables</h3>
<ul>
<li>Multiple boxplots or histograms can be laid out side-by-side or overlaid.</li>
</ul>
</section>
<section id="challenge-4" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-4">CHALLENGE</h3>
<p>Read in the dataset “KamilarAndCooperData”, which contains a host of summary information about 213 primate species.</p>
<p>Spend some time exploring the data on your own and then make boxplots of <strong>log(female body mass) ~ family</strong>. Try doing this with {base} graphics and then look at how we might do in in {ggplot2}, which provides a standard “grammar of graphics” (see the <a href="http://docs.ggplot2.org/current/">{ggplot2} documentation</a>)</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/KamilarAndCooperData.csv"</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<details><summary>Show Output</summary>
<pre class="details" data-summary="Show Output"><code>## # A tibble: 6 × 45
##   Scientific_Name        Superfamily Family Genus Species Brain_Size_Species_M…¹
##   &lt;chr&gt;                  &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;                    &lt;dbl&gt;
## 1 Allenopithecus_nigrov… Cercopithe… Cerco… Alle… nigrov…                   58.0
## 2 Allocebus_trichotis    Cercopithe… Cerco… Allo… tricho…                   NA  
## 3 Alouatta_belzebul      Ceboidea    Ateli… Alou… belzeb…                   52.8
## 4 Alouatta_caraya        Ceboidea    Ateli… Alou… caraya                    52.6
## 5 Alouatta_guariba       Ceboidea    Ateli… Alou… guariba                   51.7
## 6 Alouatta_palliata      Ceboidea    Ateli… Alou… pallia…                   49.9
## # ℹ abbreviated name: ¹​Brain_Size_Species_Mean
## # ℹ 39 more variables: Brain_Size_Female_Mean &lt;dbl&gt;, Brain_size_Ref &lt;chr&gt;,
## #   Body_mass_male_mean &lt;dbl&gt;, Body_mass_female_mean &lt;dbl&gt;,
## #   Mass_Dimorphism &lt;dbl&gt;, Mass_Ref &lt;chr&gt;, MeanGroupSize &lt;dbl&gt;,
## #   AdultMales &lt;dbl&gt;, AdultFemale &lt;dbl&gt;, AdultSexRatio &lt;dbl&gt;,
## #   Social_Organization_Ref &lt;chr&gt;, InterbirthInterval_d &lt;dbl&gt;, Gestation &lt;dbl&gt;,
## #   WeaningAge_d &lt;dbl&gt;, MaxLongevity_m &lt;dbl&gt;, LitterSz &lt;dbl&gt;, …</code></pre>
</details>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">skim</span>(d)  <span class="co"># formats results to a wide table</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co"># here we make use of the `%&gt;%` operator and {dplyr} verbs... see below</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>s <span class="sc">%&gt;%</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(skim_variable <span class="sc">==</span> <span class="st">"Scientific_Name"</span> <span class="sc">|</span> skim_type <span class="sc">==</span> <span class="st">"numeric"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">variable =</span> skim_variable, <span class="at">missing =</span> n_missing, <span class="at">mean =</span> numeric.mean, <span class="at">sd =</span> numeric.sd,</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">min =</span> numeric.p0, <span class="at">p25 =</span> numeric.p25, <span class="at">median =</span> numeric.p50, <span class="at">p75 =</span> numeric.p75,</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">max =</span> numeric.p100, <span class="at">hist =</span> numeric.hist) <span class="sc">%&gt;%</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(variable, missing, mean, sd, min, median, max, hist) <span class="sc">%&gt;%</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># drop p25 and p75 for purposes of display</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">10</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">missing</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">min</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">median</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">max</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Scientific_Name</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brain_Size_Species_Mean</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">68.109649</td>
<td style="text-align: right;">7.768403e+01</td>
<td style="text-align: right;">1.630</td>
<td style="text-align: right;">61.45000</td>
<td style="text-align: right;">491.2700</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Brain_Size_Female_Mean</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">65.235879</td>
<td style="text-align: right;">7.371151e+01</td>
<td style="text-align: right;">1.660</td>
<td style="text-align: right;">57.20000</td>
<td style="text-align: right;">480.1500</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Body_mass_male_mean</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">8111.800513</td>
<td style="text-align: right;">1.920858e+04</td>
<td style="text-align: right;">31.000</td>
<td style="text-align: right;">4290.00000</td>
<td style="text-align: right;">170400.0000</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Body_mass_female_mean</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">5396.473846</td>
<td style="text-align: right;">1.008896e+04</td>
<td style="text-align: right;">30.000</td>
<td style="text-align: right;">3039.00000</td>
<td style="text-align: right;">97500.0000</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mass_Dimorphism</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">1.246005</td>
<td style="text-align: right;">3.212141e-01</td>
<td style="text-align: right;">0.841</td>
<td style="text-align: right;">1.10900</td>
<td style="text-align: right;">2.6880</td>
<td style="text-align: left;">▇▃▂▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MeanGroupSize</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">15.055065</td>
<td style="text-align: right;">1.759245e+01</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">7.80000</td>
<td style="text-align: right;">90.0000</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">AdultMales</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">2.515621</td>
<td style="text-align: right;">2.373255e+00</td>
<td style="text-align: right;">0.900</td>
<td style="text-align: right;">1.50000</td>
<td style="text-align: right;">16.0000</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AdultFemale</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">5.048655</td>
<td style="text-align: right;">5.428615e+00</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">2.90000</td>
<td style="text-align: right;">25.2000</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">AdultSexRatio</td>
<td style="text-align: right;">84</td>
<td style="text-align: right;">2.304729</td>
<td style="text-align: right;">2.192575e+00</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">1.45000</td>
<td style="text-align: right;">15.6000</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">InterbirthInterval_d</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">572.058546</td>
<td style="text-align: right;">3.549477e+02</td>
<td style="text-align: right;">144.470</td>
<td style="text-align: right;">476.93000</td>
<td style="text-align: right;">2007.5000</td>
<td style="text-align: left;">▇▅▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gestation</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">163.465362</td>
<td style="text-align: right;">3.740063e+01</td>
<td style="text-align: right;">59.990</td>
<td style="text-align: right;">165.04000</td>
<td style="text-align: right;">256.0000</td>
<td style="text-align: left;">▁▃▇▃▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WeaningAge_d</td>
<td style="text-align: right;">95</td>
<td style="text-align: right;">310.042881</td>
<td style="text-align: right;">2.546776e+02</td>
<td style="text-align: right;">40.000</td>
<td style="text-align: right;">237.73500</td>
<td style="text-align: right;">1260.8100</td>
<td style="text-align: left;">▇▅▂▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">MaxLongevity_m</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">327.331701</td>
<td style="text-align: right;">1.259496e+02</td>
<td style="text-align: right;">103.000</td>
<td style="text-align: right;">303.60000</td>
<td style="text-align: right;">720.0000</td>
<td style="text-align: left;">▅▇▆▂▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LitterSz</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">1.180542</td>
<td style="text-align: right;">3.601098e-01</td>
<td style="text-align: right;">0.990</td>
<td style="text-align: right;">1.01000</td>
<td style="text-align: right;">2.5200</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">GR_MidRangeLat_dd</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">-1.796457</td>
<td style="text-align: right;">1.362270e+01</td>
<td style="text-align: right;">-24.500</td>
<td style="text-align: right;">-0.76000</td>
<td style="text-align: right;">35.8800</td>
<td style="text-align: left;">▆▆▇▂▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Precip_Mean_mm</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">1543.134286</td>
<td style="text-align: right;">5.158597e+02</td>
<td style="text-align: right;">419.000</td>
<td style="text-align: right;">1541.90000</td>
<td style="text-align: right;">2794.3000</td>
<td style="text-align: left;">▂▅▇▅▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">Temp_Mean_degC</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">23.132000</td>
<td style="text-align: right;">3.405405e+00</td>
<td style="text-align: right;">2.600</td>
<td style="text-align: right;">24.30000</td>
<td style="text-align: right;">27.4000</td>
<td style="text-align: left;">▁▁▁▂▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AET_Mean_mm</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">1253.112000</td>
<td style="text-align: right;">2.635696e+02</td>
<td style="text-align: right;">453.100</td>
<td style="text-align: right;">1291.10000</td>
<td style="text-align: right;">1828.3000</td>
<td style="text-align: left;">▁▃▆▇▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">PET_Mean_mm</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">1553.158857</td>
<td style="text-align: right;">1.567096e+02</td>
<td style="text-align: right;">842.500</td>
<td style="text-align: right;">1566.90000</td>
<td style="text-align: right;">1927.3000</td>
<td style="text-align: left;">▁▁▂▇▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HomeRange_km2</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">1.937905</td>
<td style="text-align: right;">5.210604e+00</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.27500</td>
<td style="text-align: right;">28.2400</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">DayLength_km</td>
<td style="text-align: right;">104</td>
<td style="text-align: right;">1.551449</td>
<td style="text-align: right;">1.439277e+00</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">1.21200</td>
<td style="text-align: right;">11.0000</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Territoriality</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">2.228885</td>
<td style="text-align: right;">2.201259e+00</td>
<td style="text-align: right;">0.225</td>
<td style="text-align: right;">1.59235</td>
<td style="text-align: right;">15.5976</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fruit</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">47.736956</td>
<td style="text-align: right;">2.408200e+01</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">48.00000</td>
<td style="text-align: right;">97.0000</td>
<td style="text-align: left;">▅▇▇▇▃</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Canine_Dimorphism</td>
<td style="text-align: right;">92</td>
<td style="text-align: right;">1.617438</td>
<td style="text-align: right;">6.722173e-01</td>
<td style="text-align: right;">0.880</td>
<td style="text-align: right;">1.56000</td>
<td style="text-align: right;">5.2630</td>
<td style="text-align: left;">▇▃▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Feed</td>
<td style="text-align: right;">141</td>
<td style="text-align: right;">33.075833</td>
<td style="text-align: right;">1.366899e+01</td>
<td style="text-align: right;">9.000</td>
<td style="text-align: right;">33.30000</td>
<td style="text-align: right;">63.9000</td>
<td style="text-align: left;">▇▇▇▇▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Move</td>
<td style="text-align: right;">143</td>
<td style="text-align: right;">21.668857</td>
<td style="text-align: right;">1.059124e+01</td>
<td style="text-align: right;">3.000</td>
<td style="text-align: right;">21.00000</td>
<td style="text-align: right;">70.6000</td>
<td style="text-align: left;">▅▇▂▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rest</td>
<td style="text-align: right;">143</td>
<td style="text-align: right;">34.259571</td>
<td style="text-align: right;">1.967175e+01</td>
<td style="text-align: right;">4.000</td>
<td style="text-align: right;">30.48000</td>
<td style="text-align: right;">78.5000</td>
<td style="text-align: left;">▇▇▅▆▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Social</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">7.368701</td>
<td style="text-align: right;">5.242077e+00</td>
<td style="text-align: right;">0.900</td>
<td style="text-align: right;">5.40000</td>
<td style="text-align: right;">23.5000</td>
<td style="text-align: left;">▇▃▃▁▁</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>kableExtra)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>skimr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also make boxplots summarizing a numerical variable in relation to another categorical variable.</p>
<p>Plotting using {base} graphics… the <code>~</code> operator can be read as “by”.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">log</span>(d<span class="sc">$</span>Body_mass_female_mean) <span class="sc">~</span> d<span class="sc">$</span>Family)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Alternatively, plotting using {ggplot2}…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> Family, <span class="at">y =</span> <span class="fu">log</span>(Body_mass_female_mean)))</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"log(Female Body Mass)"</span>)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bivariate-scatterplots" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="bivariate-scatterplots">Bivariate Scatterplots</h3>
<p>Scatterplots are a natural tool for visualizing two continuous variables and can be made easily with the <code>plot(x=&lt;variable 1&gt;, y=&lt;variable 2&gt;)</code> function in {base} graphics (where <code>&lt;variable 1&gt;</code> and <code>&lt;variable 2&gt;</code> denote the names of the two variables you wish to plot). Transformations of the variables, e.g., <code>log</code> or square root (<code>sqrt()</code>), may be necessary for effective visualization.</p>
</section>
<section id="challenge-5" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-5">CHALLENGE</h3>
<ul>
<li>Again using data from the “KamilarAndCooperData” dataset, plot the relationship between female body size and female brain size. Then, play with log transforming the data and plot again.</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))  <span class="co"># sets up two panels side by side</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> d<span class="sc">$</span>Body_mass_female_mean, <span class="at">y =</span> d<span class="sc">$</span>Brain_Size_Female_Mean)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> <span class="fu">log</span>(d<span class="sc">$</span>Body_mass_female_mean), <span class="at">y =</span> <span class="fu">log</span>(d<span class="sc">$</span>Brain_Size_Female_Mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The grammar for {ggplot2} is a bit more complicated… see if you can follow it in the example below.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(Body_mass_female_mean), <span class="at">y =</span> <span class="fu">log</span>(Brain_Size_Female_Mean),</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">factor</span>(Family)))  <span class="co"># first, we build a plot object and color points by Family</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># then we modify the axis labels</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"log(Female Body Mass)"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"log(Female Brain Size)"</span>)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co"># then we make a scatterplot</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="co"># then we modify the legend</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="co"># and, finally, we plot the object</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can use the cool package {ggExtra} to add marginal univariate plots to our bivariate scatterplots, too.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggExtra)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(p, <span class="at">type =</span> <span class="st">"densigram"</span>)  <span class="co"># try with other types, too!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>ggExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using {ggplot2}, we can also easily set up a grid for “faceting”” by a grouping variable…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Family, <span class="at">ncol =</span> <span class="dv">4</span>)  <span class="co"># wrap data 'by' family into 4 columns</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In {ggplot2} can easily add regression lines to our plot. Here, we add a linear model to each facet.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> <span class="cn">FALSE</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The <code>scatterplot()</code> function from the {car} package also produces nice bivariate plots and includes barplots along the margins.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplot</span>(<span class="at">data =</span> d, <span class="fu">log</span>(Brain_Size_Female_Mean) <span class="sc">~</span> <span class="fu">log</span>(Body_mass_female_mean), <span class="at">xlab =</span> <span class="st">"log(Female Body Mass"</span>,</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"log(Female Brain Size"</span>, <span class="at">boxplots =</span> <span class="st">"xy"</span>, <span class="at">regLine =</span> <span class="fu">list</span>(<span class="at">method =</span> lm,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="challenge-6" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-6">CHALLENGE</h3>
<ul>
<li>Build your own bivariate scatterplot of <strong>log(MaxLongevity_m)</strong> by <strong>log(Body_mass_female_mean)</strong> using the “KamilarAndCooperData” dataset.</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(Body_mass_female_mean), <span class="at">y =</span> <span class="fu">log</span>(MaxLongevity_m)))</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>## `geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can also use either the <code>pairs()</code> function from {base} <strong><em>R</em></strong>, the <code>scatterplotMatrix()</code> function from the {car} package, or the <code>pairs.panel()</code> function from the {psych} package to do multiple scatterplots simulaneously. The <code>ggpairs()</code> function from the {GGally} package can also be used, but it is slower.</p>
</section>
<section id="challenge-7" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="challenge-7">CHALLENGE</h3>
<p>Select the variables <strong>Brain_Size_Female_Mean</strong>, <strong>Body_mass_female_mean</strong>, <strong>MeanGroupSize</strong>, <strong>WeaningAge_d</strong>, <strong>MaxLongevity_m</strong>, <strong>HomeRange_km2</strong>, and <strong>DayLength_km</strong> from data frame <strong>d</strong> and plot scatterplots of all pairs of variables.</p>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> Here we are using the <code>select()</code> function from the {dplyr} package, which we cover in more detail in <a href="10-module.html"><strong>Module 10</strong></a>.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">select</span>(d, <span class="fu">c</span>(<span class="st">"Brain_Size_Female_Mean"</span>, <span class="st">"Body_mass_female_mean"</span>, <span class="st">"MeanGroupSize"</span>,</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"WeaningAge_d"</span>, <span class="st">"MaxLongevity_m"</span>, <span class="st">"HomeRange_km2"</span>, <span class="st">"DayLength_km"</span>))</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(s[, <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(s)])  <span class="co"># or</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="at">data =</span> s, <span class="sc">~</span>.)  <span class="co"># NAs are ignored by default</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co"># adding argument `upper.panel=NULL` will suppress plots above the diagonal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The {car} package function <code>scatterplotMatrix()</code> provides a more customizable interface to the <code>pairs()</code> function from {base} <strong><em>R</em></strong>. It includes a neat rug plot for each variable.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplotMatrix</span>(s, <span class="at">smooth =</span> <span class="cn">TRUE</span>, <span class="at">regLine =</span> <span class="fu">list</span>(<span class="at">method =</span> lm, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>),</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ellipse =</span> <span class="cn">TRUE</span>, <span class="at">upper.panel =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The {psych} package also makes it easy to construct a scatterplot matrix with customizable output using the <code>pairs.panel()</code> function. Here, <code>method=</code> specifies the correlation method, <code>density=</code> specifies whether to superimpose a density curve on the histogram, and <code>elipses=</code> specifies whether to show correlation elipses.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs.panels</span>(s[], <span class="at">smooth =</span> <span class="cn">FALSE</span>, <span class="at">lm =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="st">"pearson"</span>, <span class="at">hist.col =</span> <span class="st">"#00AFBB"</span>,</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">density =</span> <span class="cn">TRUE</span>, <span class="at">ellipses =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NAs are ignored by default</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>psych)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The {GGally} package lets us do something similar…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(s, <span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(s))  <span class="co"># NAs produce a warning</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>GGally)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, we can do a nice correlation plot using the {corrplot} package, where we get a matrix of correlations among variables and a graphical representation of the strength and direction of the bivariate correlation coefficients among them.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">=</span> <span class="fu">cor</span>(s, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot.mixed</span>(cor, <span class="at">lower.col =</span> <span class="st">"black"</span>, <span class="at">number.cex =</span> <span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="custom-layouts-for-multiple-plots" class="level2" data-number="9.7">
<h2 data-number="9.7" class="anchored" data-anchor-id="custom-layouts-for-multiple-plots"><span class="header-section-number">9.7</span> Custom Layouts for Multiple Plots</h2>
<p>Above, we saw the typical {base} <strong><em>R</em></strong> method for laying out plots, using the <code>par()</code> command with the <code>mfrow=</code> argument to set up a grid of panels in which to plot to the current graphics output device. There are, however, several easier ways for combining plots into custom layouts. Three alternatives are provided in the {patchwork}, {cowplot}, and {gridExtra} packages. Each starts by generating plot objects, typically using {ggplot2}. First, we create 3 plot objects using the KamilarAndCooper dataset:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(Body_mass_female_mean), <span class="at">y =</span> <span class="fu">log</span>(MaxLongevity_m)))</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"log(Female Body Size)"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"log(Lifespan)"</span>)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(Body_mass_male_mean), <span class="at">y =</span> <span class="fu">log</span>(MaxLongevity_m)))</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p2 <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p2 <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p2 <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"log(Male Body Size)"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"log(Lifespan)"</span>)</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> Family, <span class="at">y =</span> <span class="fu">log</span>(Body_mass_female_mean)))</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> p3 <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> p3 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> p3 <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Family"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"log(Female Body Mass)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once we have these plot objects, we can arrange them in custom ways using these different packages. Some alternative ways of arranging these three plots in 2 rows, with 2 panels in the top row and 1 in the bottom row, are given below…</p>
<p>The {patchwork} package is perhaps the easiest to use!</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">|</span> p2)<span class="sc">/</span>p3 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also use {cowplot}…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(<span class="fu">plot_grid</span>(p1, p2, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">label_size =</span> <span class="dv">12</span>, <span class="at">nrow =</span> <span class="dv">1</span>), p3,</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"C"</span>), <span class="at">label_size =</span> <span class="dv">12</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>cowplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>… or {gridExtra}</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">grid.arrange</span>(p1, p2, <span class="at">nrow =</span> <span class="dv">1</span>), p3, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09-module_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="aggregate-statistics" class="level2" data-number="9.8">
<h2 data-number="9.8" class="anchored" data-anchor-id="aggregate-statistics"><span class="header-section-number">9.8</span> Aggregate Statistics</h2>
<p>To calculate summary statistics for <em>groups</em> of observations in a data frame, there are many different approaches. One is to use the <code>aggregate()</code> function from the {stats} package (a {base} <strong><em>R</em></strong> standard package), which provides a quick way to look at summary statistics for sets of observations, though it requires a bit of clunky code. Here, we apply a particular function (<code>FUN = "mean"</code>) to mean female body mass, grouped by <strong>Family</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(d<span class="sc">$</span>Body_mass_female_mean <span class="sc">~</span> d<span class="sc">$</span>Family, <span class="at">FUN =</span> <span class="st">"mean"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##           d$Family d$Body_mass_female_mean
## 1         Atelidae               6616.2000
## 2          Cebidae                876.3323
## 3  Cercopithecidae               6327.8247
## 4    Cheirogalidae                186.0286
## 5    Daubentonidae               2490.0000
## 6        Galagidae                371.6143
## 7        Hominidae              53443.7167
## 8      Hylobatidae               6682.1200
## 9        Indriidae               3886.5333
## 10       Lemuridae               1991.1200
## 11   Lepilemuridae                813.5000
## 12       Lorisidae                489.8625
## 13     Pitheciidae               1768.5000
## 14       Tarsiidae                120.0000</code></pre>
</div>
</div>
<p>Or, alternatively…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(<span class="at">x =</span> d[<span class="st">"Body_mass_female_mean"</span>], <span class="at">by =</span> d[<span class="st">"Family"</span>], <span class="at">FUN =</span> <span class="st">"mean"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##             Family Body_mass_female_mean
## 1         Atelidae             6616.2000
## 2          Cebidae              876.3323
## 3  Cercopithecidae             6327.8247
## 4    Cheirogalidae              186.0286
## 5    Daubentonidae             2490.0000
## 6        Galagidae              371.6143
## 7        Hominidae            53443.7167
## 8      Hylobatidae             6682.1200
## 9        Indriidae             3886.5333
## 10       Lemuridae             1991.1200
## 11   Lepilemuridae              813.5000
## 12       Lorisidae              489.8625
## 13     Pitheciidae             1768.5000
## 14       Tarsiidae              120.0000</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># | include: false</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>curl)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="concept-review" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="concept-review">Concept Review</h2>
<ul>
<li>Summary statistics: <code>summary()</code>, <code>skim()</code></li>
<li>Basic plotting: <code>boxplot()</code>, <code>barplot()</code>, <code>histogram()</code></li>
<li>Plotting with {ggplot2}: <code>ggplot(data = , mapping = aes()) + geom() + theme() + ...</code></li>
<li>Summarizing by groups: <code>aggregrate()</code></li>
<li>Arranging plots with {patchwork}, {cowplot}, and {gridExtra}</li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./08-module.html" class="pagination-link  aria-label=" &lt;span="" data="" into="" ***r***&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Getting Data into <strong><em>R</em></strong></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./10-module.html" class="pagination-link" aria-label="<span class='chapter-number'>10</span>&nbsp; <span class='chapter-title'>Data Wrangling</span>">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Wrangling</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb113" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="an">output:</span><span class="co"> html_document</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exploratory Data Analysis {#module-09}</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="fu">## Objectives</span></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The objective of this module to begin exploring data using the summary functions and graphing abilities of ***R***.</span></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preliminaries</span></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>GO TO: <span class="ot">&lt;https://github.com/difiore/ada-datasets&gt;</span>, select the ".csv" version of the "Country-Data-2016" file, then press the "RAW" button, highlight, and copy the text to a text editor and save it locally. Do the same for the "KamilarAndCooperData" file.</span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Install these packages in ***R***: <span class="co">[</span><span class="ot">{skimr}</span><span class="co">](https://cran.r-project.org/web/packages/skimr/skimr.pdf)</span>, <span class="co">[</span><span class="ot">{summarytools}</span><span class="co">](https://cran.r-project.org/web/packages/summarytools/summarytools.pdf)</span>, <span class="co">[</span><span class="ot">{dataMaid}</span><span class="co">](https://cran.r-project.org/web/packages/dataMaid/dataMaid.pdf)</span>, <span class="co">[</span><span class="ot">{psych}</span><span class="co">](https://cran.r-project.org/web/packages/psych/psych.pdf)</span>, <span class="co">[</span><span class="ot">{pastecs}</span><span class="co">](https://cran.r-project.org/web/packages/pastecs/pastecs.pdf)</span>, <span class="co">[</span><span class="ot">{Hmisc}</span><span class="co">](https://cran.r-project.org/web/packages/Hmisc/Hmisc.pdf)</span>, <span class="co">[</span><span class="ot">{ggExtra}</span><span class="co">](https://cran.r-project.org/web/packages/ggExtra/ggExtra.pdf)</span>, <span class="co">[</span><span class="ot">{car}</span><span class="co">](https://cran.r-project.org/web/packages/car/car.pdf)</span>, <span class="co">[</span><span class="ot">{GGally}</span><span class="co">](https://cran.r-project.org/web/packages/GGally/GGally.pdf)</span>, <span class="co">[</span><span class="ot">{corrplot}</span><span class="co">](https://cran.r-project.org/web/packages/corrplot/corrplot.pdf)</span>, <span class="co">[</span><span class="ot">{patchwork}</span><span class="co">](https://cran.r-project.org/web/packages/patchwork/patchwork.pdf)</span>, <span class="co">[</span><span class="ot">{cowplot}</span><span class="co">](https://cran.r-project.org/web/packages/cowplot/cowplot.pdf)</span>, and <span class="co">[</span><span class="ot">{gridExtra}</span><span class="co">](https://cran.r-project.org/web/packages/gridExtra/gridExtra.pdf)</span></span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Load {curl} and {tidyverse}</span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(curl)</span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a><span class="fu">## Backstory</span></span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-29"><a href="#cb113-29" aria-hidden="true" tabindex="-1"></a>Exploratory data analysis (EDA) is typically the first step in any kind of data analysis in which you examine your dataset, often using visual methods, to summarize the main characteristics of your variables (central tendency, distributions) and check for various issues that may complicate further analysis (e.g., missing data). The influential statistician, John Tukey, wrote a classic book on the subject, ***Exploratory Data Analysis*** (Addison-Wesley) in 1977, in which he advocated the use of the *five-number summary* to quickly understand the distributions of numeric variables. These include:</span>
<span id="cb113-30"><a href="#cb113-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-31"><a href="#cb113-31" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the sample minimum (i.e., the value of the smallest observation)</span>
<span id="cb113-32"><a href="#cb113-32" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the lower or first quartile</span>
<span id="cb113-33"><a href="#cb113-33" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the median (i.e., the middle value in the distribution of observation)</span>
<span id="cb113-34"><a href="#cb113-34" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the upper quartile or third quartile</span>
<span id="cb113-35"><a href="#cb113-35" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the sample maximum (i.e., the value of the largest observation)</span>
<span id="cb113-36"><a href="#cb113-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-37"><a href="#cb113-37" aria-hidden="true" tabindex="-1"></a>***R*** has some very easy to use functions for taking a quick tour of your data. We have seen some of these already (e.g., <span class="in">`head()`</span>, <span class="in">`tail()`</span>, and <span class="in">`str()`</span>), and you should always use these right after loading in a dataset to work with. Also useful are <span class="in">`dim()`</span> to return the number of rows and columns in a data frame, <span class="in">`names()`</span>, <span class="in">`colnames()`</span>, and sometimes <span class="in">`rownames()`</span>.</span>
<span id="cb113-38"><a href="#cb113-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-39"><a href="#cb113-39" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** You can use the `attach()` function to make variables within data frames accessible in ***R*** with fewer keystrokes. The `attach()` function binds the variables from data frame named as an argument to the local namespace so that as long as the data frame is attached, variables can be called by their names without explicitly referring to the data frame. That is, if you `attach()` a data frame, then you do not need to use the **\$** operator or **double bracket notation** to refer to a particular variable or column vector from your data frame.</span></span>
<span id="cb113-40"><a href="#cb113-40" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb113-41"><a href="#cb113-41" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; It is important to remember to </span><span class="in">`detach()`</span><span class="at"> data frames when finished. It is also possible to attach multiple data frames (or the same data frame multiple times), and, if these share variable names, then the more recently attached one will mask the other. Thus, it is best to attach only one data frame at a time. You can also </span><span class="in">`attach()`</span><span class="at"> and </span><span class="in">`detach()`</span><span class="at"> packages from the namespace. In general, I do not recommend using </span><span class="in">`attach()`</span><span class="at"> and </span><span class="in">`detach()`</span><span class="at"> for dataframes.</span></span>
<span id="cb113-42"><a href="#cb113-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-43"><a href="#cb113-43" aria-hidden="true" tabindex="-1"></a>**EXAMPLE:**</span>
<span id="cb113-44"><a href="#cb113-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-47"><a href="#cb113-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-48"><a href="#cb113-48" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb113-49"><a href="#cb113-49" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb113-50"><a href="#cb113-50" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/Country-Data-2016.csv"</span></span>
<span id="cb113-51"><a href="#cb113-51" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-52"><a href="#cb113-52" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(d)</span>
<span id="cb113-53"><a href="#cb113-53" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(d)</span>
<span id="cb113-54"><a href="#cb113-54" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(life_expect, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-55"><a href="#cb113-55" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(d)</span>
<span id="cb113-56"><a href="#cb113-56" aria-hidden="true" tabindex="-1"></a><span class="co"># mean(life_expect, na.rm=TRUE) # this throws an error!</span></span>
<span id="cb113-57"><a href="#cb113-57" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(d<span class="sc">$</span>life_expect, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-58"><a href="#cb113-58" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-59"><a href="#cb113-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-60"><a href="#cb113-60" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** The </span><span class="in">`with()`</span><span class="at"> function accomplishes much the same thing as </span><span class="in">`attach()`</span><span class="at"> but is self-contained and cleaner, especially for use in functions. If you use </span><span class="in">`with()`</span><span class="at">, however, all code to be run should be included as an argument of the function.</span></span>
<span id="cb113-61"><a href="#cb113-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-62"><a href="#cb113-62" aria-hidden="true" tabindex="-1"></a>**EXAMPLE:**</span>
<span id="cb113-63"><a href="#cb113-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-66"><a href="#cb113-66" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-67"><a href="#cb113-67" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(d, <span class="fu">mean</span>(life_expect, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb113-68"><a href="#cb113-68" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-69"><a href="#cb113-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-70"><a href="#cb113-70" aria-hidden="true" tabindex="-1"></a><span class="fu">## "Tidy" Data</span></span>
<span id="cb113-71"><a href="#cb113-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-72"><a href="#cb113-72" aria-hidden="true" tabindex="-1"></a>The tabular data we have worked with thus far has all been presented in a format where each row represents a single case or observation or record, and each column contains a different variable that is scored for each of these observations. Data in this format is referred to as "tidy", and the {tidyverse} set of ***R*** packages (which we have used a bit already) provides many tools for manipulating tabular data in this format.</span>
<span id="cb113-73"><a href="#cb113-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-76"><a href="#cb113-76" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-77"><a href="#cb113-77" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb113-78"><a href="#cb113-78" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "80%"</span></span>
<span id="cb113-79"><a href="#cb113-79" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"img/tidydata.png"</span>)</span>
<span id="cb113-80"><a href="#cb113-80" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-81"><a href="#cb113-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-82"><a href="#cb113-82" aria-hidden="true" tabindex="-1"></a>Having data in a "tidy" format is useful for many kinds of analyses (although "tidy" data is not the ONLY useful data format). Often, then, the first manipulations we need to do with data in order to work with it efficiently are to reformat it to make it "tidy".</span>
<span id="cb113-83"><a href="#cb113-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-84"><a href="#cb113-84" aria-hidden="true" tabindex="-1"></a>There are multiple ways that data can be "non-tidy", but one common one way is because data is organized in such a way to make data entry in a spreadsheet easier. For example, consider the following table of data representing body weight in grams for three individual titi monkeys, a species of South American primate, collected in each of two years:</span>
<span id="cb113-85"><a href="#cb113-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-86"><a href="#cb113-86" aria-hidden="true" tabindex="-1"></a>| Individual | Year_1 | Year_2 |</span>
<span id="cb113-87"><a href="#cb113-87" aria-hidden="true" tabindex="-1"></a>|:-----------|:------:|:------:|</span>
<span id="cb113-88"><a href="#cb113-88" aria-hidden="true" tabindex="-1"></a>| Lily       |  580   |  600   |</span>
<span id="cb113-89"><a href="#cb113-89" aria-hidden="true" tabindex="-1"></a>| Leia       |  550   |  575   |</span>
<span id="cb113-90"><a href="#cb113-90" aria-hidden="true" tabindex="-1"></a>| Loki       |  600   |  620   |</span>
<span id="cb113-91"><a href="#cb113-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-92"><a href="#cb113-92" aria-hidden="true" tabindex="-1"></a>This data is easy to ENTER, but it is non-tidy... Why? Because the latter two columns actually represent a combinations of two variables ("Year" and "Weight") that pertain to a given individual. Each row thus represents two observations.</span>
<span id="cb113-93"><a href="#cb113-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-94"><a href="#cb113-94" aria-hidden="true" tabindex="-1"></a>Below is the same data in tidy format, where each row represents a single observation:</span>
<span id="cb113-95"><a href="#cb113-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-96"><a href="#cb113-96" aria-hidden="true" tabindex="-1"></a>| Individual |  Year  | Weight |</span>
<span id="cb113-97"><a href="#cb113-97" aria-hidden="true" tabindex="-1"></a>|:-----------|:------:|:------:|</span>
<span id="cb113-98"><a href="#cb113-98" aria-hidden="true" tabindex="-1"></a>| Lily       | Year_1 |  580   |</span>
<span id="cb113-99"><a href="#cb113-99" aria-hidden="true" tabindex="-1"></a>| Lily       | Year_2 |  600   |</span>
<span id="cb113-100"><a href="#cb113-100" aria-hidden="true" tabindex="-1"></a>| Leia       | Year_1 |  550   |</span>
<span id="cb113-101"><a href="#cb113-101" aria-hidden="true" tabindex="-1"></a>| Leia       | Year_2 |  575   |</span>
<span id="cb113-102"><a href="#cb113-102" aria-hidden="true" tabindex="-1"></a>| Loki       | Year_1 |  600   |</span>
<span id="cb113-103"><a href="#cb113-103" aria-hidden="true" tabindex="-1"></a>| Loki       | Year_2 |  620   |</span>
<span id="cb113-104"><a href="#cb113-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-105"><a href="#cb113-105" aria-hidden="true" tabindex="-1"></a>We can convert data from the former format to the latter using the function <span class="in">`pivot_longer()`</span>, where the first argument is the tabular data of interest, the next argument is a vector of columns to collect data from, the <span class="in">`names_to=`</span> argument is the name we will assign to a new variable that indicates from which column values are being collected from in the non-tidy dataset, and the final argument, <span class="in">`values_to=`</span>, is the name for the new variable into which we are collecting values. This process has the effect, often, of making "wide" tables narrower and longer, thus is sometime referred to as converting data to "long" format, thus the name for the function, <span class="in">`pivot_longer()`</span>. Note that this function is essentially an update of an older {tidyr} function, <span class="in">`gather()`</span>, which had a less intuitive name and set of argument names.</span>
<span id="cb113-106"><a href="#cb113-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-109"><a href="#cb113-109" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-110"><a href="#cb113-110" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb113-111"><a href="#cb113-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb113-112"><a href="#cb113-112" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Individual"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Lily"</span>, <span class="st">"Leia"</span>, <span class="st">"Loki"</span>),</span>
<span id="cb113-113"><a href="#cb113-113" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Year_1"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">580</span>, <span class="dv">550</span>, <span class="dv">600</span>),</span>
<span id="cb113-114"><a href="#cb113-114" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Year_2"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">600</span>, <span class="dv">575</span>, <span class="dv">620</span>)</span>
<span id="cb113-115"><a href="#cb113-115" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb113-116"><a href="#cb113-116" aria-hidden="true" tabindex="-1"></a>d</span>
<span id="cb113-117"><a href="#cb113-117" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(d, <span class="fu">c</span>(<span class="st">"Year_1"</span>, <span class="st">"Year_2"</span>), <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to =</span> <span class="st">"Weight"</span>)</span>
<span id="cb113-118"><a href="#cb113-118" aria-hidden="true" tabindex="-1"></a>d</span>
<span id="cb113-119"><a href="#cb113-119" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-120"><a href="#cb113-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-121"><a href="#cb113-121" aria-hidden="true" tabindex="-1"></a>Alternatively, sometimes we will have data that is non-tidy because variables for the same observation are presented in different rows. Consider the following example of "non-tidy" data:</span>
<span id="cb113-122"><a href="#cb113-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-123"><a href="#cb113-123" aria-hidden="true" tabindex="-1"></a>| Species     |    Variable     | Value |</span>
<span id="cb113-124"><a href="#cb113-124" aria-hidden="true" tabindex="-1"></a>|:------------|:---------------:|:-----:|</span>
<span id="cb113-125"><a href="#cb113-125" aria-hidden="true" tabindex="-1"></a>| Orangutans  | Body Size (kg)  |  37   |</span>
<span id="cb113-126"><a href="#cb113-126" aria-hidden="true" tabindex="-1"></a>| Orangutans  | Brain Size (cc) |  340  |</span>
<span id="cb113-127"><a href="#cb113-127" aria-hidden="true" tabindex="-1"></a>| Chimpanzees | Body Size (kg)  |  38   |</span>
<span id="cb113-128"><a href="#cb113-128" aria-hidden="true" tabindex="-1"></a>| Chimpanzees | Brain Size (cc) |  350  |</span>
<span id="cb113-129"><a href="#cb113-129" aria-hidden="true" tabindex="-1"></a>| Gorillas    | Body Size (kg)  |  80   |</span>
<span id="cb113-130"><a href="#cb113-130" aria-hidden="true" tabindex="-1"></a>| Gorillas    | Brain Size (cc) |  470  |</span>
<span id="cb113-131"><a href="#cb113-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-132"><a href="#cb113-132" aria-hidden="true" tabindex="-1"></a>The same data **could** be represented in "tidy" format as:</span>
<span id="cb113-133"><a href="#cb113-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-134"><a href="#cb113-134" aria-hidden="true" tabindex="-1"></a>| Species     | Body Size (kg) | Brain Size (cc) |</span>
<span id="cb113-135"><a href="#cb113-135" aria-hidden="true" tabindex="-1"></a>|:------------|:--------------:|:---------------:|</span>
<span id="cb113-136"><a href="#cb113-136" aria-hidden="true" tabindex="-1"></a>| Orangutans  |       37       |       340       |</span>
<span id="cb113-137"><a href="#cb113-137" aria-hidden="true" tabindex="-1"></a>| Chimpanzees |       38       |       350       |</span>
<span id="cb113-138"><a href="#cb113-138" aria-hidden="true" tabindex="-1"></a>| Gorillas    |       80       |       470       |</span>
<span id="cb113-139"><a href="#cb113-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-140"><a href="#cb113-140" aria-hidden="true" tabindex="-1"></a>The <span class="in">`pivot_wider()`</span> function lets us easily reformat. Here, <span class="in">`names_from=`</span> is the column containing the different variables, and <span class="in">`values_from=`</span> is the column containing the measured values of those variables. Note that this function is essentially an update of an older {tidyr} function, <span class="in">`spread()`</span>.</span>
<span id="cb113-141"><a href="#cb113-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-144"><a href="#cb113-144" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-145"><a href="#cb113-145" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb113-146"><a href="#cb113-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb113-147"><a href="#cb113-147" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Species"</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb113-148"><a href="#cb113-148" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Orangutans"</span>,</span>
<span id="cb113-149"><a href="#cb113-149" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Orangutans"</span>,</span>
<span id="cb113-150"><a href="#cb113-150" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Chimpanzees"</span>,</span>
<span id="cb113-151"><a href="#cb113-151" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Chimpanzees"</span>,</span>
<span id="cb113-152"><a href="#cb113-152" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Gorillas"</span>,</span>
<span id="cb113-153"><a href="#cb113-153" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Gorillas"</span></span>
<span id="cb113-154"><a href="#cb113-154" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb113-155"><a href="#cb113-155" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Variable"</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Body Size (kg)"</span>, <span class="st">"Brain Size (cc)"</span>), <span class="dv">3</span>),</span>
<span id="cb113-156"><a href="#cb113-156" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Value"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">37</span>, <span class="dv">340</span>, <span class="dv">38</span>, <span class="dv">350</span>, <span class="dv">80</span>, <span class="dv">470</span>)</span>
<span id="cb113-157"><a href="#cb113-157" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb113-158"><a href="#cb113-158" aria-hidden="true" tabindex="-1"></a>d</span>
<span id="cb113-159"><a href="#cb113-159" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(d, <span class="at">names_from =</span> <span class="st">"Variable"</span>, <span class="at">values_from =</span> <span class="st">"Value"</span>)</span>
<span id="cb113-160"><a href="#cb113-160" aria-hidden="true" tabindex="-1"></a>d</span>
<span id="cb113-161"><a href="#cb113-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-162"><a href="#cb113-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-163"><a href="#cb113-163" aria-hidden="true" tabindex="-1"></a>This process has the effect, often, of making long and narrow tables wider, thus is sometime referred to as converting data to "wide" format.</span>
<span id="cb113-164"><a href="#cb113-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-165"><a href="#cb113-165" aria-hidden="true" tabindex="-1"></a>The image below, pulled from a cheatsheet on <span class="co">[</span><span class="ot">Data Wrangling with {dplyr} and {tidyr}</span><span class="co">](cheatsheets/data-wrangling.pdf)</span>, summarizes the basics of these processes for "reshaping" data.</span>
<span id="cb113-166"><a href="#cb113-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-169"><a href="#cb113-169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-170"><a href="#cb113-170" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb113-171"><a href="#cb113-171" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "90%"</span></span>
<span id="cb113-172"><a href="#cb113-172" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"img/reshaping.png"</span>)</span>
<span id="cb113-173"><a href="#cb113-173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-174"><a href="#cb113-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-175"><a href="#cb113-175" aria-hidden="true" tabindex="-1"></a>For the remainder of this module, all of the example datasets will comprise data already in the "tidy" format.</span>
<span id="cb113-176"><a href="#cb113-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-177"><a href="#cb113-177" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exploring Single Variables</span></span>
<span id="cb113-178"><a href="#cb113-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-179"><a href="#cb113-179" aria-hidden="true" tabindex="-1"></a><span class="fu">### Variable Summaries {.unnumbered}</span></span>
<span id="cb113-180"><a href="#cb113-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-181"><a href="#cb113-181" aria-hidden="true" tabindex="-1"></a>The <span class="in">`summary()`</span> function from {base} ***R*** provides a quick overview of each variable in a data frame. For **numeric** variables, this includes the five-number summary and the mean, as well as a count of `NA` (missing values). For **factors**, it includes a count of each factor.</span>
<span id="cb113-182"><a href="#cb113-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-183"><a href="#cb113-183" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb113-184"><a href="#cb113-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-185"><a href="#cb113-185" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Load the "Country-Data-2016" dataset into a data frame variable, **d**, and summarize the variables in that data frame. You can load the file any way you want, e.g., load from a local file or access the data straight from ***GitHub***, as in the code below.</span>
<span id="cb113-186"><a href="#cb113-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-189"><a href="#cb113-189" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-190"><a href="#cb113-190" aria-hidden="true" tabindex="-1"></a><span class="co"># using {base} R</span></span>
<span id="cb113-191"><a href="#cb113-191" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">curl</span>(<span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/Country-Data-2016.csv"</span>)</span>
<span id="cb113-192"><a href="#cb113-192" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(f, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb113-193"><a href="#cb113-193" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(d) <span class="co"># I like tibbles!</span></span>
<span id="cb113-194"><a href="#cb113-194" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span>
<span id="cb113-195"><a href="#cb113-195" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(d)</span>
<span id="cb113-196"><a href="#cb113-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-197"><a href="#cb113-197" aria-hidden="true" tabindex="-1"></a><span class="co"># or, using {readr}</span></span>
<span id="cb113-198"><a href="#cb113-198" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span><span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/Country-Data-2016.csv"</span></span>
<span id="cb113-199"><a href="#cb113-199" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-200"><a href="#cb113-200" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span>
<span id="cb113-201"><a href="#cb113-201" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(d)</span>
<span id="cb113-202"><a href="#cb113-202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-203"><a href="#cb113-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-204"><a href="#cb113-204" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What are the median area and population size of all countries in the dataset?</span>
<span id="cb113-205"><a href="#cb113-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-206"><a href="#cb113-206" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **HINT:** There are a couple of ways to do this... try </span><span class="in">`summary()`</span><span class="at"> and </span><span class="in">`median()`</span><span class="at"> (for the latter, you'll need to use the </span><span class="in">`na.rm=TRUE`</span><span class="at"> argument).</span></span>
<span id="cb113-207"><a href="#cb113-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-210"><a href="#cb113-210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-211"><a href="#cb113-211" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb113-212"><a href="#cb113-212" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb113-213"><a href="#cb113-213" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb113-214"><a href="#cb113-214" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(d)</span>
<span id="cb113-215"><a href="#cb113-215" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(d<span class="sc">$</span>area, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb113-216"><a href="#cb113-216" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(d<span class="sc">$</span>population, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb113-217"><a href="#cb113-217" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-218"><a href="#cb113-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-219"><a href="#cb113-219" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Create a new **density** variable in your data frame which is population / area. What are the 10 most dense countries? The 10 least dense?</span>
<span id="cb113-220"><a href="#cb113-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-221"><a href="#cb113-221" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **HINT:** Check out the </span><span class="in">`order()`</span><span class="at"> function.</span></span>
<span id="cb113-222"><a href="#cb113-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-225"><a href="#cb113-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-226"><a href="#cb113-226" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb113-227"><a href="#cb113-227" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb113-228"><a href="#cb113-228" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb113-229"><a href="#cb113-229" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>density <span class="ot">&lt;-</span> d<span class="sc">$</span>population<span class="sc">/</span>d<span class="sc">$</span>area</span>
<span id="cb113-230"><a href="#cb113-230" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d[<span class="fu">order</span>(d<span class="sc">$</span>density, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),] <span class="co"># or</span></span>
<span id="cb113-231"><a href="#cb113-231" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d[<span class="fu">order</span>(<span class="sc">-</span>d<span class="sc">$</span>density),]</span>
<span id="cb113-232"><a href="#cb113-232" aria-hidden="true" tabindex="-1"></a>d[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb113-233"><a href="#cb113-233" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d[<span class="fu">order</span>(d<span class="sc">$</span>density),]</span>
<span id="cb113-234"><a href="#cb113-234" aria-hidden="true" tabindex="-1"></a>d[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb113-235"><a href="#cb113-235" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-236"><a href="#cb113-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-237"><a href="#cb113-237" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use subsetting or filtering to extract data from the 20 largest countries into a new variable, **s**. What are the median area and population size of these countries?</span>
<span id="cb113-238"><a href="#cb113-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-241"><a href="#cb113-241" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-242"><a href="#cb113-242" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb113-243"><a href="#cb113-243" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb113-244"><a href="#cb113-244" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb113-245"><a href="#cb113-245" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> d[<span class="fu">order</span>(<span class="sc">-</span>d<span class="sc">$</span>population),]</span>
<span id="cb113-246"><a href="#cb113-246" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> s[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,]</span>
<span id="cb113-247"><a href="#cb113-247" aria-hidden="true" tabindex="-1"></a>med_area <span class="ot">&lt;-</span> <span class="fu">median</span>(s<span class="sc">$</span>area, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-248"><a href="#cb113-248" aria-hidden="true" tabindex="-1"></a>med_area</span>
<span id="cb113-249"><a href="#cb113-249" aria-hidden="true" tabindex="-1"></a>med_pop <span class="ot">&lt;-</span> <span class="fu">median</span>(s<span class="sc">$</span>population, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-250"><a href="#cb113-250" aria-hidden="true" tabindex="-1"></a>med_pop</span>
<span id="cb113-251"><a href="#cb113-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-252"><a href="#cb113-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-253"><a href="#cb113-253" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Extract data from all countries beginning with the letters "A" through "F". What are the mean area and population size of these countries?</span>
<span id="cb113-254"><a href="#cb113-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-255"><a href="#cb113-255" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** Single bracket notation subsetting is used here to return the rows of the **d** data frame where the country name (`d$country`) begins with the capital letters "A" through "F". The `grep()` function is a pattern recognition function that uses a **regular expression** to pull out the country names of interest.</span></span>
<span id="cb113-256"><a href="#cb113-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-259"><a href="#cb113-259" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-260"><a href="#cb113-260" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb113-261"><a href="#cb113-261" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb113-262"><a href="#cb113-262" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb113-263"><a href="#cb113-263" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> d[<span class="fu">grep</span>(<span class="at">pattern =</span> <span class="st">"^[A-F]"</span>, d<span class="sc">$</span>country),]</span>
<span id="cb113-264"><a href="#cb113-264" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(s)</span>
<span id="cb113-265"><a href="#cb113-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-266"><a href="#cb113-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-267"><a href="#cb113-267" aria-hidden="true" tabindex="-1"></a>Doing the same thing with {dplyr} verbs (see <span class="co">[</span><span class="ot">**Module 10**</span><span class="co">](#module-10)</span>) is easier...</span>
<span id="cb113-268"><a href="#cb113-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-271"><a href="#cb113-271" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-272"><a href="#cb113-272" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb113-273"><a href="#cb113-273" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb113-274"><a href="#cb113-274" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb113-275"><a href="#cb113-275" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">filter</span>(d, <span class="fu">grepl</span>(<span class="at">pattern =</span> <span class="st">"^[A-F]"</span>, country))</span>
<span id="cb113-276"><a href="#cb113-276" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(s)</span>
<span id="cb113-277"><a href="#cb113-277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-278"><a href="#cb113-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-279"><a href="#cb113-279" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** Here, we use </span><span class="in">`grepl()`</span><span class="at"> instead of </span><span class="in">`grep()`</span><span class="at"> because we want to return a logical vector for all of the elements of "country" to </span><span class="in">`filter()`</span><span class="at"> on the basis of. </span><span class="in">`grep()`</span><span class="at"> returns a vector of index positions.</span></span>
<span id="cb113-280"><a href="#cb113-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-281"><a href="#cb113-281" aria-hidden="true" tabindex="-1"></a>Or, instead of <span class="in">`summary()`</span>, we can use <span class="in">`mean()`</span> with the <span class="in">`na.rm=TRUE`</span> argument...</span>
<span id="cb113-282"><a href="#cb113-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-285"><a href="#cb113-285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-286"><a href="#cb113-286" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb113-287"><a href="#cb113-287" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb113-288"><a href="#cb113-288" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb113-289"><a href="#cb113-289" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(s<span class="sc">$</span>population, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-290"><a href="#cb113-290" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(s<span class="sc">$</span>area, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-291"><a href="#cb113-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-292"><a href="#cb113-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-293"><a href="#cb113-293" aria-hidden="true" tabindex="-1"></a>There are a number of other packages and associated functions we might also use to generate nice summaries of our data.</span>
<span id="cb113-294"><a href="#cb113-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-295"><a href="#cb113-295" aria-hidden="true" tabindex="-1"></a>For example, with the <span class="in">`skim()`</span> function from {skimr}, you can get for numeric variables a count of observations, the number of missing observations, the mean and standard deviation, and the five-number summary. The <span class="in">`select()`</span>, <span class="in">`kable()`</span> and <span class="in">`kable_styling()`</span> functions will format the output nicely!</span>
<span id="cb113-296"><a href="#cb113-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-299"><a href="#cb113-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-300"><a href="#cb113-300" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb113-301"><a href="#cb113-301" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb113-302"><a href="#cb113-302" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb113-303"><a href="#cb113-303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-304"><a href="#cb113-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-307"><a href="#cb113-307" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-308"><a href="#cb113-308" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">skim</span>(d) <span class="co"># the main `skimr()` function</span></span>
<span id="cb113-309"><a href="#cb113-309" aria-hidden="true" tabindex="-1"></a>s <span class="sc">%&gt;%</span> <span class="fu">filter</span>(skim_type <span class="sc">==</span> <span class="st">"numeric"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-310"><a href="#cb113-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">variable=</span>skim_variable, <span class="at">missing=</span>n_missing, <span class="at">mean=</span>numeric.mean,</span>
<span id="cb113-311"><a href="#cb113-311" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd=</span>numeric.sd, <span class="at">min=</span>numeric.p0, <span class="at">p25=</span>numeric.p25, <span class="at">median=</span>numeric.p50,</span>
<span id="cb113-312"><a href="#cb113-312" aria-hidden="true" tabindex="-1"></a>         <span class="at">p75=</span>numeric.p75, <span class="at">max=</span>numeric.p100, <span class="at">hist=</span>numeric.hist) <span class="sc">%&gt;%</span></span>
<span id="cb113-313"><a href="#cb113-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(variable, missing, mean, sd, min, median, max, hist) <span class="sc">%&gt;%</span></span>
<span id="cb113-314"><a href="#cb113-314" aria-hidden="true" tabindex="-1"></a>  <span class="co"># drop p25 and p75 for purposes of display</span></span>
<span id="cb113-315"><a href="#cb113-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb113-316"><a href="#cb113-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">10</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb113-317"><a href="#cb113-317" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-318"><a href="#cb113-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-321"><a href="#cb113-321" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-322"><a href="#cb113-322" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>kableExtra)</span>
<span id="cb113-323"><a href="#cb113-323" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>skimr)</span>
<span id="cb113-324"><a href="#cb113-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-325"><a href="#cb113-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-326"><a href="#cb113-326" aria-hidden="true" tabindex="-1"></a>With <span class="in">`descr()`</span>, <span class="in">`dfSummary()`</span>, and <span class="in">`view()`</span> from the {summarytools} package, you can also return nicely formatted tables of summary statistics. Note that the output of the code below is not shown.</span>
<span id="cb113-327"><a href="#cb113-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-328"><a href="#cb113-328" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **CAUTION:** Q1 and Q3 (the equivalent of "numeric.p25" and "numeric.p75") are calculated slightly differently for </span><span class="in">`descr()`</span><span class="at"> and </span><span class="in">`dfSummary()`</span><span class="at"> than for </span><span class="in">`summary()`</span><span class="at"> and </span><span class="in">`skim()`</span><span class="at">!</span></span>
<span id="cb113-329"><a href="#cb113-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-332"><a href="#cb113-332" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-333"><a href="#cb113-333" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb113-334"><a href="#cb113-334" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb113-335"><a href="#cb113-335" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">descr</span>(d, <span class="at">style =</span> <span class="st">"rmarkdown"</span>, <span class="at">transpose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-336"><a href="#cb113-336" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;% to view() print nicely formatted table to viewer</span></span>
<span id="cb113-337"><a href="#cb113-337" aria-hidden="true" tabindex="-1"></a>s <span class="sc">%&gt;%</span> summarytools<span class="sc">::</span><span class="fu">view</span>()</span>
<span id="cb113-338"><a href="#cb113-338" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">dfSummary</span>(d, <span class="at">style =</span> <span class="st">"grid"</span>, <span class="at">plain.ascii =</span> <span class="cn">FALSE</span>)</span>
<span id="cb113-339"><a href="#cb113-339" aria-hidden="true" tabindex="-1"></a>s <span class="sc">%&gt;%</span> summarytools<span class="sc">::</span><span class="fu">view</span>()</span>
<span id="cb113-340"><a href="#cb113-340" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>summarytools)</span>
<span id="cb113-341"><a href="#cb113-341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-342"><a href="#cb113-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-343"><a href="#cb113-343" aria-hidden="true" tabindex="-1"></a>With <span class="in">`makeDataReport()`</span> from the {dataMaid} package, you can generate a nicely formated report that gets written out to a location of your choice. Again, the output of this code is not shown as it generates a report in an external file.</span>
<span id="cb113-344"><a href="#cb113-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-347"><a href="#cb113-347" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-348"><a href="#cb113-348" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb113-349"><a href="#cb113-349" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dataMaid)</span>
<span id="cb113-350"><a href="#cb113-350" aria-hidden="true" tabindex="-1"></a><span class="co"># this code below produces a formated report, with the type of report</span></span>
<span id="cb113-351"><a href="#cb113-351" aria-hidden="true" tabindex="-1"></a><span class="co"># specified by `output=`</span></span>
<span id="cb113-352"><a href="#cb113-352" aria-hidden="true" tabindex="-1"></a><span class="fu">makeDataReport</span>(d,</span>
<span id="cb113-353"><a href="#cb113-353" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"html"</span>,</span>
<span id="cb113-354"><a href="#cb113-354" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"~/Desktop/dataMaid-output.Rmd"</span>,</span>
<span id="cb113-355"><a href="#cb113-355" aria-hidden="true" tabindex="-1"></a>  <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-356"><a href="#cb113-356" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>dataMaid)</span>
<span id="cb113-357"><a href="#cb113-357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-358"><a href="#cb113-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-359"><a href="#cb113-359" aria-hidden="true" tabindex="-1"></a>Additionally, the packages {psych}, {pastecs}, and {Hmisc} also all contain functions for producing variable summaries:</span>
<span id="cb113-360"><a href="#cb113-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-361"><a href="#cb113-361" aria-hidden="true" tabindex="-1"></a><span class="in">`psych::describe(d)`</span></span>
<span id="cb113-362"><a href="#cb113-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-363"><a href="#cb113-363" aria-hidden="true" tabindex="-1"></a><span class="in">`pastecs::stat.desc(d)`</span></span>
<span id="cb113-364"><a href="#cb113-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-365"><a href="#cb113-365" aria-hidden="true" tabindex="-1"></a><span class="in">`Hmisc::describe(d)`</span></span>
<span id="cb113-366"><a href="#cb113-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-367"><a href="#cb113-367" aria-hidden="true" tabindex="-1"></a><span class="fu">### Boxplots, Barplots, and Dotcharts {.unnumbered}</span></span>
<span id="cb113-368"><a href="#cb113-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-369"><a href="#cb113-369" aria-hidden="true" tabindex="-1"></a>The <span class="in">`boxplot()`</span> function from {base} ***R*** provides a box-and-whiskers visual representation of the five-number summary, sometimes noting outliers that go beyond the bulk of the data. The function balks if you pass it nonnumeric data, so you will want to reference columns of interest specifically using either **double bracket notation** or the **\$** operator.</span>
<span id="cb113-370"><a href="#cb113-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-371"><a href="#cb113-371" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** Actually, it is technically not true that </span><span class="in">`boxplot()`</span><span class="at"> always shows you the five-number summary. One of the default arguments for </span><span class="in">`boxplot()`</span><span class="at"> includes </span><span class="in">`range=1.5`</span><span class="at">, which means that the "whiskers" of the boxplot extend to 1.5 times the interquartile range, and then values more extreme than that are indicated as single points. If </span><span class="in">`range=0`</span><span class="at">, then, the "whiskers" extend to the minimum and maximum values of the data.</span></span>
<span id="cb113-372"><a href="#cb113-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-373"><a href="#cb113-373" aria-hidden="true" tabindex="-1"></a>The <span class="in">`barplot()`</span> function is also useful taking a quick look at crude data, with bar height proportional to the value of the variable. The function <span class="in">`dotchart()`</span> provides a similar graphical summary.</span>
<span id="cb113-374"><a href="#cb113-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-375"><a href="#cb113-375" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb113-376"><a href="#cb113-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-377"><a href="#cb113-377" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Make boxplots, barplots, and dotcharts of the raw population and area data, then <span class="in">`log()`</span> transform the variables and repeat the boxplots.</span>
<span id="cb113-378"><a href="#cb113-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-379"><a href="#cb113-379" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** The </span><span class="in">`par()`</span><span class="at"> command in the code below lets you set up a grid of panels in which to plot. Here, we set up a 1 row x 2 column grid.</span></span>
<span id="cb113-380"><a href="#cb113-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-383"><a href="#cb113-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-384"><a href="#cb113-384" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb113-385"><a href="#cb113-385" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb113-386"><a href="#cb113-386" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb113-387"><a href="#cb113-387" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb113-388"><a href="#cb113-388" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>log_population <span class="ot">&lt;-</span> <span class="fu">log</span>(d<span class="sc">$</span>population)</span>
<span id="cb113-389"><a href="#cb113-389" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>log_area <span class="ot">&lt;-</span> <span class="fu">log</span>(d<span class="sc">$</span>area)</span>
<span id="cb113-390"><a href="#cb113-390" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(d<span class="sc">$</span>population, <span class="at">ylab =</span> <span class="st">"Population"</span>)</span>
<span id="cb113-391"><a href="#cb113-391" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(d<span class="sc">$</span>area, <span class="at">ylab =</span> <span class="st">"Area"</span>)</span>
<span id="cb113-392"><a href="#cb113-392" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(d<span class="sc">$</span>population, <span class="at">xlab =</span> <span class="st">"Case"</span>, <span class="at">ylab =</span> <span class="st">"Population"</span>)</span>
<span id="cb113-393"><a href="#cb113-393" aria-hidden="true" tabindex="-1"></a><span class="fu">dotchart</span>(d<span class="sc">$</span>population, <span class="at">xlab =</span> <span class="st">"Population"</span>, <span class="at">ylab =</span> <span class="st">"Case"</span>)</span>
<span id="cb113-394"><a href="#cb113-394" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(d<span class="sc">$</span>area, <span class="at">xlab =</span> <span class="st">"Case"</span>, <span class="at">ylab =</span> <span class="st">"Area"</span>)</span>
<span id="cb113-395"><a href="#cb113-395" aria-hidden="true" tabindex="-1"></a><span class="fu">dotchart</span>(d<span class="sc">$</span>area, <span class="at">xlab =</span> <span class="st">"Area"</span>, <span class="at">ylab =</span> <span class="st">"Case"</span>)</span>
<span id="cb113-396"><a href="#cb113-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-397"><a href="#cb113-397" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(d<span class="sc">$</span>log_population, <span class="at">ylab =</span> <span class="st">"log(Population)"</span>)</span>
<span id="cb113-398"><a href="#cb113-398" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(d<span class="sc">$</span>log_area, <span class="at">ylab =</span> <span class="st">"log(Area)"</span>)</span>
<span id="cb113-399"><a href="#cb113-399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-400"><a href="#cb113-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-401"><a href="#cb113-401" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plotting with {ggplot2} {.unnumbered}</span></span>
<span id="cb113-402"><a href="#cb113-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-403"><a href="#cb113-403" aria-hidden="true" tabindex="-1"></a>As an alternative for plotting, we can use the "grammar of graphics" {ggplot2} package:</span>
<span id="cb113-404"><a href="#cb113-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-407"><a href="#cb113-407" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-408"><a href="#cb113-408" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb113-409"><a href="#cb113-409" aria-hidden="true" tabindex="-1"></a><span class="co"># first, we use `tidyr::pivot_longer()` to convert our data from wide to long format</span></span>
<span id="cb113-410"><a href="#cb113-410" aria-hidden="true" tabindex="-1"></a><span class="co"># this is so we can use `facet.grid()`</span></span>
<span id="cb113-411"><a href="#cb113-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-412"><a href="#cb113-412" aria-hidden="true" tabindex="-1"></a><span class="co"># uncomment this to look at a different set of variables</span></span>
<span id="cb113-413"><a href="#cb113-413" aria-hidden="true" tabindex="-1"></a><span class="co"># d_long &lt;- pivot_longer(d, c("log_population","log_area"),</span></span>
<span id="cb113-414"><a href="#cb113-414" aria-hidden="true" tabindex="-1"></a><span class="co"># names_to="Variable", values_to="Value")</span></span>
<span id="cb113-415"><a href="#cb113-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-416"><a href="#cb113-416" aria-hidden="true" tabindex="-1"></a><span class="co"># uncomment this to look at a different set of variables</span></span>
<span id="cb113-417"><a href="#cb113-417" aria-hidden="true" tabindex="-1"></a><span class="co"># d_long &lt;- pivot_longer(d, c("mammals","birds","reptiles","fishes"),</span></span>
<span id="cb113-418"><a href="#cb113-418" aria-hidden="true" tabindex="-1"></a><span class="co"># names_to="Variable", values_to="Value")</span></span>
<span id="cb113-419"><a href="#cb113-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-420"><a href="#cb113-420" aria-hidden="true" tabindex="-1"></a>d_long <span class="ot">&lt;-</span></span>
<span id="cb113-421"><a href="#cb113-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(d,</span>
<span id="cb113-422"><a href="#cb113-422" aria-hidden="true" tabindex="-1"></a>         <span class="fu">c</span>(<span class="st">"birthrate"</span>, <span class="st">"deathrate"</span>, <span class="st">"life_expect"</span>),</span>
<span id="cb113-423"><a href="#cb113-423" aria-hidden="true" tabindex="-1"></a>         <span class="at">names_to =</span> <span class="st">"Variable"</span>,</span>
<span id="cb113-424"><a href="#cb113-424" aria-hidden="true" tabindex="-1"></a>         <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb113-425"><a href="#cb113-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-426"><a href="#cb113-426" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(<span class="dv">0</span>), <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb113-427"><a href="#cb113-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb113-428"><a href="#cb113-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb113-429"><a href="#cb113-429" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb113-430"><a href="#cb113-430" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb113-431"><a href="#cb113-431" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb113-432"><a href="#cb113-432" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb113-433"><a href="#cb113-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(</span>
<span id="cb113-434"><a href="#cb113-434" aria-hidden="true" tabindex="-1"></a>    <span class="at">binaxis =</span> <span class="st">'y'</span>,</span>
<span id="cb113-435"><a href="#cb113-435" aria-hidden="true" tabindex="-1"></a>    <span class="at">stackdir =</span> <span class="st">'center'</span>,</span>
<span id="cb113-436"><a href="#cb113-436" aria-hidden="true" tabindex="-1"></a>    <span class="at">stackratio =</span> <span class="fl">0.2</span>,</span>
<span id="cb113-437"><a href="#cb113-437" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb113-438"><a href="#cb113-438" aria-hidden="true" tabindex="-1"></a>    <span class="at">dotsize =</span> <span class="fl">0.5</span>,</span>
<span id="cb113-439"><a href="#cb113-439" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NA</span>,</span>
<span id="cb113-440"><a href="#cb113-440" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"red"</span>,</span>
<span id="cb113-441"><a href="#cb113-441" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb113-442"><a href="#cb113-442" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb113-443"><a href="#cb113-443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Variable) <span class="sc">+</span></span>
<span id="cb113-444"><a href="#cb113-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="at">sides =</span> <span class="st">"l"</span>)</span>
<span id="cb113-445"><a href="#cb113-445" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb113-446"><a href="#cb113-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-447"><a href="#cb113-447" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(<span class="dv">0</span>), <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb113-448"><a href="#cb113-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb113-449"><a href="#cb113-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb113-450"><a href="#cb113-450" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb113-451"><a href="#cb113-451" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb113-452"><a href="#cb113-452" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb113-453"><a href="#cb113-453" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb113-454"><a href="#cb113-454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(</span>
<span id="cb113-455"><a href="#cb113-455" aria-hidden="true" tabindex="-1"></a>    <span class="at">binaxis =</span> <span class="st">'y'</span>,</span>
<span id="cb113-456"><a href="#cb113-456" aria-hidden="true" tabindex="-1"></a>    <span class="at">stackdir =</span> <span class="st">'center'</span>,</span>
<span id="cb113-457"><a href="#cb113-457" aria-hidden="true" tabindex="-1"></a>    <span class="at">stackratio =</span> <span class="fl">0.2</span>,</span>
<span id="cb113-458"><a href="#cb113-458" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb113-459"><a href="#cb113-459" aria-hidden="true" tabindex="-1"></a>    <span class="at">dotsize =</span> <span class="fl">0.5</span>,</span>
<span id="cb113-460"><a href="#cb113-460" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NA</span>,</span>
<span id="cb113-461"><a href="#cb113-461" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"red"</span>,</span>
<span id="cb113-462"><a href="#cb113-462" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb113-463"><a href="#cb113-463" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb113-464"><a href="#cb113-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Variable) <span class="sc">+</span></span>
<span id="cb113-465"><a href="#cb113-465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="at">sides =</span> <span class="st">"l"</span>)</span>
<span id="cb113-466"><a href="#cb113-466" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb113-467"><a href="#cb113-467" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-468"><a href="#cb113-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-469"><a href="#cb113-469" aria-hidden="true" tabindex="-1"></a><span class="fu">### Histograms {.unnumbered}</span></span>
<span id="cb113-470"><a href="#cb113-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-471"><a href="#cb113-471" aria-hidden="true" tabindex="-1"></a>The <span class="in">`hist()`</span> function returns a histogram showing the complete empirical distribution of the data in binned categories, which is useful for checking skewwness of the data, symmetry, multi-modality, etc. Setting the argument <span class="in">`freq=FALSE`</span> will scale the Y axis to represent the *proportion* of observations falling into each bin rather than the *count*.</span>
<span id="cb113-472"><a href="#cb113-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-473"><a href="#cb113-473" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb113-474"><a href="#cb113-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-475"><a href="#cb113-475" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Make histograms of the <span class="in">`log()`</span> transformed population and area data from the "Country-Data-2016" file. Explore what happens if you set <span class="in">`freq=FALSE`</span> versus the default of <span class="in">`freq=TRUE`</span>. Try looking at other variables as well.</span>
<span id="cb113-476"><a href="#cb113-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-479"><a href="#cb113-479" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-480"><a href="#cb113-480" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb113-481"><a href="#cb113-481" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb113-482"><a href="#cb113-482" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb113-483"><a href="#cb113-483" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb113-484"><a href="#cb113-484" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="co"># sets up two panels side by side</span></span>
<span id="cb113-485"><a href="#cb113-485" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(d) <span class="co"># lets us use variable names without specifying the data frame!</span></span>
<span id="cb113-486"><a href="#cb113-486" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb113-487"><a href="#cb113-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(population),</span>
<span id="cb113-488"><a href="#cb113-488" aria-hidden="true" tabindex="-1"></a>  <span class="at">freq =</span> <span class="cn">FALSE</span>,</span>
<span id="cb113-489"><a href="#cb113-489" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"red"</span>,</span>
<span id="cb113-490"><a href="#cb113-490" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Plot 1"</span>,</span>
<span id="cb113-491"><a href="#cb113-491" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"log(population size)"</span>,</span>
<span id="cb113-492"><a href="#cb113-492" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"density"</span>,</span>
<span id="cb113-493"><a href="#cb113-493" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)</span>
<span id="cb113-494"><a href="#cb113-494" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb113-495"><a href="#cb113-495" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb113-496"><a href="#cb113-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(area),</span>
<span id="cb113-497"><a href="#cb113-497" aria-hidden="true" tabindex="-1"></a>  <span class="at">freq =</span> <span class="cn">FALSE</span>,</span>
<span id="cb113-498"><a href="#cb113-498" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"red"</span>,</span>
<span id="cb113-499"><a href="#cb113-499" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Plot 2"</span>,</span>
<span id="cb113-500"><a href="#cb113-500" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"log(area)"</span>,</span>
<span id="cb113-501"><a href="#cb113-501" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"density"</span>,</span>
<span id="cb113-502"><a href="#cb113-502" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)</span>
<span id="cb113-503"><a href="#cb113-503" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb113-504"><a href="#cb113-504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-505"><a href="#cb113-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-506"><a href="#cb113-506" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** You can add lines to your histograms (e.g., to show the mean value for a variable) using the </span><span class="in">`abline()`</span><span class="at"> command, with arguments. For example, to show a single *vertical* line representing the mean log(population size), you would add the argument </span><span class="in">`v=mean(log(area), na.rm=TRUE)`</span><span class="at">. We need to set </span><span class="in">`na.rm`</span><span class="at"> to be TRUE otherwise the </span><span class="in">`mean()`</span><span class="at"> function will not run the way we expect.</span></span>
<span id="cb113-507"><a href="#cb113-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-510"><a href="#cb113-510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-511"><a href="#cb113-511" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb113-512"><a href="#cb113-512" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb113-513"><a href="#cb113-513" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb113-514"><a href="#cb113-514" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb113-515"><a href="#cb113-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(area),</span>
<span id="cb113-516"><a href="#cb113-516" aria-hidden="true" tabindex="-1"></a>  <span class="at">freq =</span> <span class="cn">FALSE</span>,</span>
<span id="cb113-517"><a href="#cb113-517" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"red"</span>,</span>
<span id="cb113-518"><a href="#cb113-518" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Plot 2"</span>,</span>
<span id="cb113-519"><a href="#cb113-519" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"log(area)"</span>,</span>
<span id="cb113-520"><a href="#cb113-520" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"density"</span>,</span>
<span id="cb113-521"><a href="#cb113-521" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)</span>
<span id="cb113-522"><a href="#cb113-522" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb113-523"><a href="#cb113-523" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(<span class="fu">log</span>(area), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb113-524"><a href="#cb113-524" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-525"><a href="#cb113-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-526"><a href="#cb113-526" aria-hidden="true" tabindex="-1"></a><span class="fu">### Density Plots {.unnumbered}</span></span>
<span id="cb113-527"><a href="#cb113-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-528"><a href="#cb113-528" aria-hidden="true" tabindex="-1"></a>The <span class="in">`density()`</span> function computes a non-parametric estimate of the distribution of a variable, which can be combined with other plots to also yield a graphical view of the distribution of the data. If your data have missing values, then you need to add the argument <span class="in">`na.rm=TRUE`</span> to the <span class="in">`density()`</span> function. To superimpose a <span class="in">`density()`</span> curve on a histogram, you can use the <span class="in">`lines(density())`</span> function.</span>
<span id="cb113-529"><a href="#cb113-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-532"><a href="#cb113-532" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-533"><a href="#cb113-533" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb113-534"><a href="#cb113-534" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)) <span class="co"># set up one panel and redraw the log(population) histogram</span></span>
<span id="cb113-535"><a href="#cb113-535" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb113-536"><a href="#cb113-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(population),</span>
<span id="cb113-537"><a href="#cb113-537" aria-hidden="true" tabindex="-1"></a>  <span class="at">freq =</span> <span class="cn">FALSE</span>,</span>
<span id="cb113-538"><a href="#cb113-538" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"white"</span>,</span>
<span id="cb113-539"><a href="#cb113-539" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Density Plot with Mean"</span>,</span>
<span id="cb113-540"><a href="#cb113-540" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"log(population size)"</span>,</span>
<span id="cb113-541"><a href="#cb113-541" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"density"</span>,</span>
<span id="cb113-542"><a href="#cb113-542" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)</span>
<span id="cb113-543"><a href="#cb113-543" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb113-544"><a href="#cb113-544" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(<span class="fu">log</span>(population), <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb113-545"><a href="#cb113-545" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(<span class="fu">log</span>(population), <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb113-546"><a href="#cb113-546" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(d)</span>
<span id="cb113-547"><a href="#cb113-547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-548"><a href="#cb113-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-549"><a href="#cb113-549" aria-hidden="true" tabindex="-1"></a><span class="fu">### Tables {.unnumbered}</span></span>
<span id="cb113-550"><a href="#cb113-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-551"><a href="#cb113-551" aria-hidden="true" tabindex="-1"></a>The <span class="in">`table()`</span> function can be used to summarize counts and proportions for categorical variables in your dataset.</span>
<span id="cb113-552"><a href="#cb113-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-553"><a href="#cb113-553" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb113-554"><a href="#cb113-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-555"><a href="#cb113-555" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Using the <span class="in">`table()`</span> function, find what is the most common form of government in the "Country-Data-2016" dataset. How many countries have that form?</span>
<span id="cb113-556"><a href="#cb113-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-557"><a href="#cb113-557" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **HINT:** We can combine </span><span class="in">`table()`</span><span class="at"> with </span><span class="in">`sort()`</span><span class="at"> and the argument </span><span class="in">`decreasing=TRUE`</span><span class="at"> to get the desired answered straight away.</span></span>
<span id="cb113-558"><a href="#cb113-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-561"><a href="#cb113-561" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-562"><a href="#cb113-562" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb113-563"><a href="#cb113-563" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb113-564"><a href="#cb113-564" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb113-565"><a href="#cb113-565" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">table</span>(d<span class="sc">$</span>govt_form), <span class="at">decreasing=</span><span class="cn">TRUE</span>)</span>
<span id="cb113-566"><a href="#cb113-566" aria-hidden="true" tabindex="-1"></a>t</span>
<span id="cb113-567"><a href="#cb113-567" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-568"><a href="#cb113-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-569"><a href="#cb113-569" aria-hidden="true" tabindex="-1"></a>Doing the same thing with {dplyr} verbs (see <span class="co">[</span><span class="ot">**Module 10**</span><span class="co">](#module-10)</span>) provides nicer output...</span>
<span id="cb113-570"><a href="#cb113-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-573"><a href="#cb113-573" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-574"><a href="#cb113-574" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span></span>
<span id="cb113-575"><a href="#cb113-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(d, govt_form) <span class="sc">%&gt;%</span></span>
<span id="cb113-576"><a href="#cb113-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb113-577"><a href="#cb113-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span>
<span id="cb113-578"><a href="#cb113-578" aria-hidden="true" tabindex="-1"></a>t</span>
<span id="cb113-579"><a href="#cb113-579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-580"><a href="#cb113-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-581"><a href="#cb113-581" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exploring Multiple Variables</span></span>
<span id="cb113-582"><a href="#cb113-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-583"><a href="#cb113-583" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plotting Several Variables {.unnumbered}</span></span>
<span id="cb113-584"><a href="#cb113-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-585"><a href="#cb113-585" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Multiple boxplots or histograms can be laid out side-by-side or overlaid.</span>
<span id="cb113-586"><a href="#cb113-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-587"><a href="#cb113-587" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb113-588"><a href="#cb113-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-589"><a href="#cb113-589" aria-hidden="true" tabindex="-1"></a>Read in the dataset "KamilarAndCooperData", which contains a host of summary information about 213 primate species.</span>
<span id="cb113-590"><a href="#cb113-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-591"><a href="#cb113-591" aria-hidden="true" tabindex="-1"></a>Spend some time exploring the data on your own and then make boxplots of **log(female body mass) \~ family**. Try doing this with {base} graphics and then look at how we might do in in {ggplot2}, which provides a standard "grammar of graphics" (see the <span class="co">[</span><span class="ot">{ggplot2} documentation</span><span class="co">](http://docs.ggplot2.org/current/)</span>)</span>
<span id="cb113-592"><a href="#cb113-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-595"><a href="#cb113-595" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-596"><a href="#cb113-596" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb113-597"><a href="#cb113-597" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb113-598"><a href="#cb113-598" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb113-599"><a href="#cb113-599" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb113-600"><a href="#cb113-600" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/KamilarAndCooperData.csv"</span></span>
<span id="cb113-601"><a href="#cb113-601" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(f, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-602"><a href="#cb113-602" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span>
<span id="cb113-603"><a href="#cb113-603" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-604"><a href="#cb113-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-607"><a href="#cb113-607" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-608"><a href="#cb113-608" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb113-609"><a href="#cb113-609" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb113-610"><a href="#cb113-610" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb113-611"><a href="#cb113-611" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-612"><a href="#cb113-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-615"><a href="#cb113-615" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-616"><a href="#cb113-616" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb113-617"><a href="#cb113-617" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb113-618"><a href="#cb113-618" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb113-619"><a href="#cb113-619" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">skim</span>(d) <span class="co"># formats results to a wide table</span></span>
<span id="cb113-620"><a href="#cb113-620" aria-hidden="true" tabindex="-1"></a><span class="co"># here we make use of the `%&gt;%` operator and {dplyr} verbs... see below</span></span>
<span id="cb113-621"><a href="#cb113-621" aria-hidden="true" tabindex="-1"></a>s <span class="sc">%&gt;%</span></span>
<span id="cb113-622"><a href="#cb113-622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(skim_variable <span class="sc">==</span> <span class="st">"Scientific_Name"</span> <span class="sc">|</span> skim_type <span class="sc">==</span> <span class="st">"numeric"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-623"><a href="#cb113-623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">variable=</span>skim_variable, <span class="at">missing=</span>n_missing, <span class="at">mean=</span>numeric.mean,</span>
<span id="cb113-624"><a href="#cb113-624" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd=</span>numeric.sd, <span class="at">min=</span>numeric.p0, <span class="at">p25=</span>numeric.p25, <span class="at">median=</span>numeric.p50,</span>
<span id="cb113-625"><a href="#cb113-625" aria-hidden="true" tabindex="-1"></a>    <span class="at">p75=</span>numeric.p75, <span class="at">max=</span>numeric.p100, <span class="at">hist=</span>numeric.hist) <span class="sc">%&gt;%</span></span>
<span id="cb113-626"><a href="#cb113-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(variable, missing, mean, sd, min, median, max, hist) <span class="sc">%&gt;%</span></span>
<span id="cb113-627"><a href="#cb113-627" aria-hidden="true" tabindex="-1"></a>  <span class="co"># drop p25 and p75 for purposes of display</span></span>
<span id="cb113-628"><a href="#cb113-628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb113-629"><a href="#cb113-629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">10</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb113-630"><a href="#cb113-630" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-631"><a href="#cb113-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-634"><a href="#cb113-634" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-635"><a href="#cb113-635" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb113-636"><a href="#cb113-636" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>kableExtra)</span>
<span id="cb113-637"><a href="#cb113-637" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>skimr)</span>
<span id="cb113-638"><a href="#cb113-638" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-639"><a href="#cb113-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-640"><a href="#cb113-640" aria-hidden="true" tabindex="-1"></a>We can also make boxplots summarizing a numerical variable in relation to another categorical variable.</span>
<span id="cb113-641"><a href="#cb113-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-642"><a href="#cb113-642" aria-hidden="true" tabindex="-1"></a>Plotting using {base} graphics... the <span class="in">`~`</span> operator can be read as "by".</span>
<span id="cb113-643"><a href="#cb113-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-646"><a href="#cb113-646" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-647"><a href="#cb113-647" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">log</span>(d<span class="sc">$</span>Body_mass_female_mean)<span class="sc">~</span>d<span class="sc">$</span>Family)</span>
<span id="cb113-648"><a href="#cb113-648" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-649"><a href="#cb113-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-650"><a href="#cb113-650" aria-hidden="true" tabindex="-1"></a>Alternatively, plotting using {ggplot2}...</span>
<span id="cb113-651"><a href="#cb113-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-654"><a href="#cb113-654" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-655"><a href="#cb113-655" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>d, <span class="fu">aes</span>(<span class="at">x=</span>Family, <span class="at">y=</span><span class="fu">log</span>(Body_mass_female_mean)))</span>
<span id="cb113-656"><a href="#cb113-656" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb113-657"><a href="#cb113-657" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>))</span>
<span id="cb113-658"><a href="#cb113-658" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"log(Female Body Mass)"</span>)</span>
<span id="cb113-659"><a href="#cb113-659" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb113-660"><a href="#cb113-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-661"><a href="#cb113-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-662"><a href="#cb113-662" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bivariate Scatterplots {.unnumbered}</span></span>
<span id="cb113-663"><a href="#cb113-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-664"><a href="#cb113-664" aria-hidden="true" tabindex="-1"></a>Scatterplots are a natural tool for visualizing two continuous variables and can be made easily with the <span class="in">`plot(x=&lt;variable 1&gt;, y=&lt;variable 2&gt;)`</span> function in {base} graphics (where <span class="in">`&lt;variable 1&gt;`</span> and <span class="in">`&lt;variable 2&gt;`</span> denote the names of the two variables you wish to plot). Transformations of the variables, e.g., <span class="in">`log`</span> or square root (<span class="in">`sqrt()`</span>), may be necessary for effective visualization.</span>
<span id="cb113-665"><a href="#cb113-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-666"><a href="#cb113-666" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb113-667"><a href="#cb113-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-668"><a href="#cb113-668" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Again using data from the "KamilarAndCooperData" dataset, plot the relationship between female body size and female brain size. Then, play with log transforming the data and plot again.</span>
<span id="cb113-669"><a href="#cb113-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-672"><a href="#cb113-672" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-673"><a href="#cb113-673" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb113-674"><a href="#cb113-674" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb113-675"><a href="#cb113-675" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb113-676"><a href="#cb113-676" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="co"># sets up two panels side by side</span></span>
<span id="cb113-677"><a href="#cb113-677" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> d<span class="sc">$</span>Body_mass_female_mean, <span class="at">y =</span> d<span class="sc">$</span>Brain_Size_Female_Mean)</span>
<span id="cb113-678"><a href="#cb113-678" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> <span class="fu">log</span>(d<span class="sc">$</span>Body_mass_female_mean), <span class="at">y =</span> <span class="fu">log</span>(d<span class="sc">$</span>Brain_Size_Female_Mean))</span>
<span id="cb113-679"><a href="#cb113-679" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-680"><a href="#cb113-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-681"><a href="#cb113-681" aria-hidden="true" tabindex="-1"></a>The grammar for {ggplot2} is a bit more complicated... see if you can follow it in the example below.</span>
<span id="cb113-682"><a href="#cb113-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-685"><a href="#cb113-685" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-686"><a href="#cb113-686" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>d, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log</span>(Body_mass_female_mean),</span>
<span id="cb113-687"><a href="#cb113-687" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y=</span><span class="fu">log</span>(Brain_Size_Female_Mean),</span>
<span id="cb113-688"><a href="#cb113-688" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color =</span> <span class="fu">factor</span>(Family)</span>
<span id="cb113-689"><a href="#cb113-689" aria-hidden="true" tabindex="-1"></a>                        )) <span class="co"># first, we build a plot object and color points by Family</span></span>
<span id="cb113-690"><a href="#cb113-690" aria-hidden="true" tabindex="-1"></a><span class="co"># then we modify the axis labels</span></span>
<span id="cb113-691"><a href="#cb113-691" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"log(Female Body Mass)"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"log(Female Brain Size)"</span>)</span>
<span id="cb113-692"><a href="#cb113-692" aria-hidden="true" tabindex="-1"></a><span class="co"># then we make a scatterplot</span></span>
<span id="cb113-693"><a href="#cb113-693" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb113-694"><a href="#cb113-694" aria-hidden="true" tabindex="-1"></a><span class="co"># then we modify the legend</span></span>
<span id="cb113-695"><a href="#cb113-695" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>, <span class="at">legend.title=</span><span class="fu">element_blank</span>())</span>
<span id="cb113-696"><a href="#cb113-696" aria-hidden="true" tabindex="-1"></a><span class="co"># and, finally, we plot the object</span></span>
<span id="cb113-697"><a href="#cb113-697" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb113-698"><a href="#cb113-698" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-699"><a href="#cb113-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-700"><a href="#cb113-700" aria-hidden="true" tabindex="-1"></a>We can use the cool package {ggExtra} to add marginal univariate plots to our bivariate scatterplots, too.</span>
<span id="cb113-701"><a href="#cb113-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-704"><a href="#cb113-704" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-705"><a href="#cb113-705" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggExtra)</span>
<span id="cb113-706"><a href="#cb113-706" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(p, <span class="at">type =</span> <span class="st">"densigram"</span>) <span class="co"># try with other types, too!</span></span>
<span id="cb113-707"><a href="#cb113-707" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>ggExtra)</span>
<span id="cb113-708"><a href="#cb113-708" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-709"><a href="#cb113-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-710"><a href="#cb113-710" aria-hidden="true" tabindex="-1"></a>Using {ggplot2}, we can also easily set up a grid for "faceting"" by a grouping variable...</span>
<span id="cb113-711"><a href="#cb113-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-714"><a href="#cb113-714" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-715"><a href="#cb113-715" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span> Family, <span class="at">ncol=</span><span class="dv">4</span>) <span class="co"># wrap data "by" family into 4 columns</span></span>
<span id="cb113-716"><a href="#cb113-716" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span>
<span id="cb113-717"><a href="#cb113-717" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb113-718"><a href="#cb113-718" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-719"><a href="#cb113-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-720"><a href="#cb113-720" aria-hidden="true" tabindex="-1"></a>In {ggplot2} can easily add regression lines to our plot. Here, we add a linear model to each facet.</span>
<span id="cb113-721"><a href="#cb113-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-724"><a href="#cb113-724" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-725"><a href="#cb113-725" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb113-726"><a href="#cb113-726" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb113-727"><a href="#cb113-727" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">fullrange=</span><span class="cn">FALSE</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb113-728"><a href="#cb113-728" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb113-729"><a href="#cb113-729" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-730"><a href="#cb113-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-731"><a href="#cb113-731" aria-hidden="true" tabindex="-1"></a>The <span class="in">`scatterplot()`</span> function from the {car} package also produces nice bivariate plots and includes barplots along the margins.</span>
<span id="cb113-732"><a href="#cb113-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-735"><a href="#cb113-735" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-736"><a href="#cb113-736" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb113-737"><a href="#cb113-737" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb113-738"><a href="#cb113-738" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-739"><a href="#cb113-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-742"><a href="#cb113-742" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-743"><a href="#cb113-743" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplot</span>(</span>
<span id="cb113-744"><a href="#cb113-744" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d,</span>
<span id="cb113-745"><a href="#cb113-745" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(Brain_Size_Female_Mean) <span class="sc">~</span> <span class="fu">log</span>(Body_mass_female_mean),</span>
<span id="cb113-746"><a href="#cb113-746" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"log(Female Body Mass"</span>,</span>
<span id="cb113-747"><a href="#cb113-747" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"log(Female Brain Size"</span>,</span>
<span id="cb113-748"><a href="#cb113-748" aria-hidden="true" tabindex="-1"></a>  <span class="at">boxplots =</span> <span class="st">"xy"</span>,</span>
<span id="cb113-749"><a href="#cb113-749" aria-hidden="true" tabindex="-1"></a>  <span class="at">regLine =</span> </span>
<span id="cb113-750"><a href="#cb113-750" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb113-751"><a href="#cb113-751" aria-hidden="true" tabindex="-1"></a>       <span class="at">method =</span> lm,</span>
<span id="cb113-752"><a href="#cb113-752" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb113-753"><a href="#cb113-753" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb113-754"><a href="#cb113-754" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"red"</span></span>
<span id="cb113-755"><a href="#cb113-755" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-756"><a href="#cb113-756" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb113-757"><a href="#cb113-757" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>car)</span>
<span id="cb113-758"><a href="#cb113-758" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-759"><a href="#cb113-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-760"><a href="#cb113-760" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb113-761"><a href="#cb113-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-762"><a href="#cb113-762" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Build your own bivariate scatterplot of **log(MaxLongevity_m)** by **log(Body_mass_female_mean)** using the "KamilarAndCooperData" dataset.</span>
<span id="cb113-763"><a href="#cb113-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-766"><a href="#cb113-766" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-767"><a href="#cb113-767" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb113-768"><a href="#cb113-768" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb113-769"><a href="#cb113-769" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb113-770"><a href="#cb113-770" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>d, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log</span>(Body_mass_female_mean),</span>
<span id="cb113-771"><a href="#cb113-771" aria-hidden="true" tabindex="-1"></a>  <span class="at">y=</span><span class="fu">log</span>(MaxLongevity_m)))</span>
<span id="cb113-772"><a href="#cb113-772" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-773"><a href="#cb113-773" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-774"><a href="#cb113-774" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb113-775"><a href="#cb113-775" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-776"><a href="#cb113-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-777"><a href="#cb113-777" aria-hidden="true" tabindex="-1"></a>We can also use either the <span class="in">`pairs()`</span> function from {base} ***R***, the <span class="in">`scatterplotMatrix()`</span> function from the {car} package, or the <span class="in">`pairs.panel()`</span> function from the {psych} package to do multiple scatterplots simulaneously. The <span class="in">`ggpairs()`</span> function from the {GGally} package can also be used, but it is slower.</span>
<span id="cb113-778"><a href="#cb113-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-779"><a href="#cb113-779" aria-hidden="true" tabindex="-1"></a><span class="fu">### CHALLENGE {.unnumbered}</span></span>
<span id="cb113-780"><a href="#cb113-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-781"><a href="#cb113-781" aria-hidden="true" tabindex="-1"></a>Select the variables **Brain_Size_Female_Mean**, **Body_mass_female_mean**, **MeanGroupSize**, **WeaningAge_d**, **MaxLongevity_m**, **HomeRange_km2**, and **DayLength_km** from data frame **d** and plot scatterplots of all pairs of variables.</span>
<span id="cb113-782"><a href="#cb113-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-783"><a href="#cb113-783" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **NOTE:** Here we are using the `select()` function from the {dplyr} package, which we cover in more detail in [**Module 10**](#module-10).</span></span>
<span id="cb113-784"><a href="#cb113-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-787"><a href="#cb113-787" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-788"><a href="#cb113-788" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb113-789"><a href="#cb113-789" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show Code"</span></span>
<span id="cb113-790"><a href="#cb113-790" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr.output: '.details summary="Show Output"'</span></span>
<span id="cb113-791"><a href="#cb113-791" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span></span>
<span id="cb113-792"><a href="#cb113-792" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(d,</span>
<span id="cb113-793"><a href="#cb113-793" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb113-794"><a href="#cb113-794" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Brain_Size_Female_Mean"</span>,</span>
<span id="cb113-795"><a href="#cb113-795" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Body_mass_female_mean"</span>,</span>
<span id="cb113-796"><a href="#cb113-796" aria-hidden="true" tabindex="-1"></a>      <span class="st">"MeanGroupSize"</span>,</span>
<span id="cb113-797"><a href="#cb113-797" aria-hidden="true" tabindex="-1"></a>      <span class="st">"WeaningAge_d"</span>,</span>
<span id="cb113-798"><a href="#cb113-798" aria-hidden="true" tabindex="-1"></a>      <span class="st">"MaxLongevity_m"</span>,</span>
<span id="cb113-799"><a href="#cb113-799" aria-hidden="true" tabindex="-1"></a>      <span class="st">"HomeRange_km2"</span>,</span>
<span id="cb113-800"><a href="#cb113-800" aria-hidden="true" tabindex="-1"></a>      <span class="st">"DayLength_km"</span></span>
<span id="cb113-801"><a href="#cb113-801" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-802"><a href="#cb113-802" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb113-803"><a href="#cb113-803" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(s[,<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(s)]) <span class="co"># or</span></span>
<span id="cb113-804"><a href="#cb113-804" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="at">data=</span>s, <span class="sc">~</span>.) <span class="co"># NAs are ignored by default</span></span>
<span id="cb113-805"><a href="#cb113-805" aria-hidden="true" tabindex="-1"></a><span class="co"># adding argument `upper.panel=NULL` will suppress plots above the diagonal</span></span>
<span id="cb113-806"><a href="#cb113-806" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-807"><a href="#cb113-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-808"><a href="#cb113-808" aria-hidden="true" tabindex="-1"></a>The {car} package function <span class="in">`scatterplotMatrix()`</span> provides a more customizable interface to the <span class="in">`pairs()`</span> function from {base} ***R***. It includes a neat rug plot for each variable.</span>
<span id="cb113-809"><a href="#cb113-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-812"><a href="#cb113-812" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-813"><a href="#cb113-813" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb113-814"><a href="#cb113-814" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb113-815"><a href="#cb113-815" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-816"><a href="#cb113-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-819"><a href="#cb113-819" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-820"><a href="#cb113-820" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplotMatrix</span>(s,</span>
<span id="cb113-821"><a href="#cb113-821" aria-hidden="true" tabindex="-1"></a>  <span class="at">smooth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb113-822"><a href="#cb113-822" aria-hidden="true" tabindex="-1"></a>  <span class="at">regLine =</span> <span class="fu">list</span>(<span class="at">method =</span> lm, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>),</span>
<span id="cb113-823"><a href="#cb113-823" aria-hidden="true" tabindex="-1"></a>  <span class="at">ellipse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb113-824"><a href="#cb113-824" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper.panel =</span> <span class="cn">NULL</span></span>
<span id="cb113-825"><a href="#cb113-825" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb113-826"><a href="#cb113-826" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>car)</span>
<span id="cb113-827"><a href="#cb113-827" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-828"><a href="#cb113-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-829"><a href="#cb113-829" aria-hidden="true" tabindex="-1"></a>The {psych} package also makes it easy to construct a scatterplot matrix with customizable output using the <span class="in">`pairs.panel()`</span> function. Here, <span class="in">`method=`</span> specifies the correlation method, <span class="in">`density=`</span> specifies whether to superimpose a density curve on the histogram, and <span class="in">`elipses=`</span> specifies whether to show correlation elipses.</span>
<span id="cb113-830"><a href="#cb113-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-833"><a href="#cb113-833" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-834"><a href="#cb113-834" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb113-835"><a href="#cb113-835" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb113-836"><a href="#cb113-836" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs.panels</span>(s[], </span>
<span id="cb113-837"><a href="#cb113-837" aria-hidden="true" tabindex="-1"></a>  <span class="at">smooth =</span> <span class="cn">FALSE</span>,</span>
<span id="cb113-838"><a href="#cb113-838" aria-hidden="true" tabindex="-1"></a>  <span class="at">lm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb113-839"><a href="#cb113-839" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"pearson"</span>,</span>
<span id="cb113-840"><a href="#cb113-840" aria-hidden="true" tabindex="-1"></a>  <span class="at">hist.col =</span> <span class="st">"#00AFBB"</span>,</span>
<span id="cb113-841"><a href="#cb113-841" aria-hidden="true" tabindex="-1"></a>  <span class="at">density =</span> <span class="cn">TRUE</span>,</span>
<span id="cb113-842"><a href="#cb113-842" aria-hidden="true" tabindex="-1"></a>  <span class="at">ellipses =</span> <span class="cn">TRUE</span></span>
<span id="cb113-843"><a href="#cb113-843" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb113-844"><a href="#cb113-844" aria-hidden="true" tabindex="-1"></a><span class="co"># NAs are ignored by default</span></span>
<span id="cb113-845"><a href="#cb113-845" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>psych)</span>
<span id="cb113-846"><a href="#cb113-846" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-847"><a href="#cb113-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-848"><a href="#cb113-848" aria-hidden="true" tabindex="-1"></a>The {GGally} package lets us do something similar...</span>
<span id="cb113-849"><a href="#cb113-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-852"><a href="#cb113-852" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-853"><a href="#cb113-853" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb113-854"><a href="#cb113-854" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb113-855"><a href="#cb113-855" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb113-856"><a href="#cb113-856" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(s, <span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(s)) <span class="co"># NAs produce a warning</span></span>
<span id="cb113-857"><a href="#cb113-857" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>GGally)</span>
<span id="cb113-858"><a href="#cb113-858" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-859"><a href="#cb113-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-860"><a href="#cb113-860" aria-hidden="true" tabindex="-1"></a>Finally, we can do a nice correlation plot using the {corrplot} package, where we get a matrix of correlations among variables and a graphical representation of the strength and direction of the bivariate correlation coefficients among them.</span>
<span id="cb113-861"><a href="#cb113-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-864"><a href="#cb113-864" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-865"><a href="#cb113-865" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb113-866"><a href="#cb113-866" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb113-867"><a href="#cb113-867" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">=</span> <span class="fu">cor</span>(s, <span class="at">use=</span><span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb113-868"><a href="#cb113-868" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot.mixed</span>(cor, <span class="at">lower.col =</span> <span class="st">"black"</span>, <span class="at">number.cex =</span> .<span class="dv">7</span>)</span>
<span id="cb113-869"><a href="#cb113-869" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>corrplot)</span>
<span id="cb113-870"><a href="#cb113-870" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-871"><a href="#cb113-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-872"><a href="#cb113-872" aria-hidden="true" tabindex="-1"></a><span class="fu">## Custom Layouts for Multiple Plots</span></span>
<span id="cb113-873"><a href="#cb113-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-874"><a href="#cb113-874" aria-hidden="true" tabindex="-1"></a>Above, we saw the typical {base} ***R*** method for laying out plots, using the <span class="in">`par()`</span> command with the <span class="in">`mfrow=`</span> argument to set up a grid of panels in which to plot to the current graphics output device. There are, however, several easier ways for combining plots into custom layouts. Three alternatives are provided in the {patchwork}, {cowplot}, and {gridExtra} packages. Each starts by generating plot objects, typically using {ggplot2}. First, we create 3 plot objects using the KamilarAndCooper dataset:</span>
<span id="cb113-875"><a href="#cb113-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-878"><a href="#cb113-878" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-879"><a href="#cb113-879" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>d, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log</span>(Body_mass_female_mean), </span>
<span id="cb113-880"><a href="#cb113-880" aria-hidden="true" tabindex="-1"></a>  <span class="at">y=</span><span class="fu">log</span>(MaxLongevity_m)))</span>
<span id="cb113-881"><a href="#cb113-881" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-882"><a href="#cb113-882" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-883"><a href="#cb113-883" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"log(Female Body Size)"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"log(Lifespan)"</span>)</span>
<span id="cb113-884"><a href="#cb113-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-885"><a href="#cb113-885" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>d, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log</span>(Body_mass_male_mean),</span>
<span id="cb113-886"><a href="#cb113-886" aria-hidden="true" tabindex="-1"></a>  <span class="at">y=</span><span class="fu">log</span>(MaxLongevity_m)))</span>
<span id="cb113-887"><a href="#cb113-887" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p2 <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-888"><a href="#cb113-888" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p2 <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-889"><a href="#cb113-889" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p2 <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"log(Male Body Size)"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"log(Lifespan)"</span>)</span>
<span id="cb113-890"><a href="#cb113-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-891"><a href="#cb113-891" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>d, <span class="fu">aes</span>(<span class="at">x=</span>Family, <span class="at">y=</span><span class="fu">log</span>(Body_mass_female_mean)))</span>
<span id="cb113-892"><a href="#cb113-892" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> p3 <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb113-893"><a href="#cb113-893" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> p3 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>))</span>
<span id="cb113-894"><a href="#cb113-894" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> p3 <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Family"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"log(Female Body Mass)"</span>)</span>
<span id="cb113-895"><a href="#cb113-895" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-896"><a href="#cb113-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-897"><a href="#cb113-897" aria-hidden="true" tabindex="-1"></a>Once we have these plot objects, we can arrange them in custom ways using these different packages. Some alternative ways of arranging these three plots in 2 rows, with 2 panels in the top row and 1 in the bottom row, are given below...</span>
<span id="cb113-898"><a href="#cb113-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-899"><a href="#cb113-899" aria-hidden="true" tabindex="-1"></a>The {patchwork} package is perhaps the easiest to use!</span>
<span id="cb113-900"><a href="#cb113-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-903"><a href="#cb113-903" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-904"><a href="#cb113-904" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb113-905"><a href="#cb113-905" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb113-906"><a href="#cb113-906" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb113-907"><a href="#cb113-907" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">|</span> p2)<span class="sc">/</span>p3 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>)</span>
<span id="cb113-908"><a href="#cb113-908" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>patchwork)</span>
<span id="cb113-909"><a href="#cb113-909" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-910"><a href="#cb113-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-911"><a href="#cb113-911" aria-hidden="true" tabindex="-1"></a>We can also use {cowplot}...</span>
<span id="cb113-912"><a href="#cb113-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-915"><a href="#cb113-915" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-916"><a href="#cb113-916" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb113-917"><a href="#cb113-917" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb113-918"><a href="#cb113-918" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb113-919"><a href="#cb113-919" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(</span>
<span id="cb113-920"><a href="#cb113-920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_grid</span>(</span>
<span id="cb113-921"><a href="#cb113-921" aria-hidden="true" tabindex="-1"></a>    p1,</span>
<span id="cb113-922"><a href="#cb113-922" aria-hidden="true" tabindex="-1"></a>    p2,</span>
<span id="cb113-923"><a href="#cb113-923" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'A'</span>, <span class="st">'B'</span>),</span>
<span id="cb113-924"><a href="#cb113-924" aria-hidden="true" tabindex="-1"></a>    <span class="at">label_size =</span> <span class="dv">12</span>,</span>
<span id="cb113-925"><a href="#cb113-925" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">1</span></span>
<span id="cb113-926"><a href="#cb113-926" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb113-927"><a href="#cb113-927" aria-hidden="true" tabindex="-1"></a>  p3,</span>
<span id="cb113-928"><a href="#cb113-928" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">''</span>, <span class="st">'C'</span>),</span>
<span id="cb113-929"><a href="#cb113-929" aria-hidden="true" tabindex="-1"></a>  <span class="at">label_size =</span> <span class="dv">12</span>,</span>
<span id="cb113-930"><a href="#cb113-930" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">2</span></span>
<span id="cb113-931"><a href="#cb113-931" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb113-932"><a href="#cb113-932" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>cowplot)</span>
<span id="cb113-933"><a href="#cb113-933" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-934"><a href="#cb113-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-935"><a href="#cb113-935" aria-hidden="true" tabindex="-1"></a>... or {gridExtra}</span>
<span id="cb113-936"><a href="#cb113-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-939"><a href="#cb113-939" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-940"><a href="#cb113-940" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb113-941"><a href="#cb113-941" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb113-942"><a href="#cb113-942" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb113-943"><a href="#cb113-943" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">grid.arrange</span>(p1,p2, <span class="at">nrow=</span><span class="dv">1</span>),p3, <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb113-944"><a href="#cb113-944" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>gridExtra)</span>
<span id="cb113-945"><a href="#cb113-945" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-946"><a href="#cb113-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-947"><a href="#cb113-947" aria-hidden="true" tabindex="-1"></a><span class="fu">## Aggregate Statistics</span></span>
<span id="cb113-948"><a href="#cb113-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-949"><a href="#cb113-949" aria-hidden="true" tabindex="-1"></a>To calculate summary statistics for *groups* of observations in a data frame, there are many different approaches. One is to use the `aggregate()` function from the {stats} package (a {base} ***R*** standard package), which provides a quick way to look at summary statistics for sets of observations, though it requires a bit of clunky code. Here, we apply a particular function (`FUN = "mean"`) to mean female body mass, grouped by **Family**.</span>
<span id="cb113-950"><a href="#cb113-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-953"><a href="#cb113-953" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-954"><a href="#cb113-954" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(d<span class="sc">$</span>Body_mass_female_mean<span class="sc">~</span>d<span class="sc">$</span>Family, <span class="at">FUN =</span> <span class="st">"mean"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-955"><a href="#cb113-955" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-956"><a href="#cb113-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-957"><a href="#cb113-957" aria-hidden="true" tabindex="-1"></a>Or, alternatively...</span>
<span id="cb113-958"><a href="#cb113-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-961"><a href="#cb113-961" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-962"><a href="#cb113-962" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(<span class="at">x =</span> d[<span class="st">"Body_mass_female_mean"</span>], <span class="at">by =</span> d[<span class="st">"Family"</span>], <span class="at">FUN =</span> <span class="st">"mean"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-963"><a href="#cb113-963" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-964"><a href="#cb113-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-967"><a href="#cb113-967" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-968"><a href="#cb113-968" aria-hidden="true" tabindex="-1"></a><span class="co"># | include: false</span></span>
<span id="cb113-969"><a href="#cb113-969" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>curl)</span>
<span id="cb113-970"><a href="#cb113-970" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>tidyverse)</span>
<span id="cb113-971"><a href="#cb113-971" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-972"><a href="#cb113-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-973"><a href="#cb113-973" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb113-974"><a href="#cb113-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-975"><a href="#cb113-975" aria-hidden="true" tabindex="-1"></a><span class="fu">## Concept Review {.unnumbered}</span></span>
<span id="cb113-976"><a href="#cb113-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-977"><a href="#cb113-977" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Summary statistics: <span class="in">`summary()`</span>, <span class="in">`skim()`</span></span>
<span id="cb113-978"><a href="#cb113-978" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Basic plotting: <span class="in">`boxplot()`</span>, <span class="in">`barplot()`</span>, <span class="in">`histogram()`</span></span>
<span id="cb113-979"><a href="#cb113-979" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Plotting with {ggplot2}: <span class="in">`ggplot(data = , mapping = aes()) + geom() + theme() + ...`</span></span>
<span id="cb113-980"><a href="#cb113-980" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Summarizing by groups: <span class="in">`aggregrate()`</span></span>
<span id="cb113-981"><a href="#cb113-981" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Arranging plots with {patchwork}, {cowplot}, and {gridExtra}</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>